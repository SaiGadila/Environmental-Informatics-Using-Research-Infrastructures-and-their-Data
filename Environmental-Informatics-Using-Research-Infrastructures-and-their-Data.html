<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Environmental Informatics Using Research Infrastructures and their Data</title>
  <meta name="description" content="Course text for NAU INF 550" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Environmental Informatics Using Research Infrastructures and their Data" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="//Users/kdw223/Research/katharynduffy.github.io/images/EcoInfo4.png" />
  <meta property="og:description" content="Course text for NAU INF 550" />
  <meta name="github-repo" content="katharynduffy/katharynduffy.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Environmental Informatics Using Research Infrastructures and their Data" />
  
  <meta name="twitter:description" content="Course text for NAU INF 550" />
  <meta name="twitter:image" content="//Users/kdw223/Research/katharynduffy.github.io/images/EcoInfo4.png" />

<meta name="author" content="Dr. Katharyn Duffy, Dr. Ben Ruddell" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Environmental Informatics Using Research Infrastructures and their Data</h1>
<p class="author"><em>Dr. Katharyn Duffy, Dr. Ben Ruddell</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#preface">Preface<span></span></a>
<ul>
<li><a href="#acknowledgements">Acknowledgements<span></span></a>
<ul>
<li><a href="#key-contributors">Key Contributors<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#pre-course-setup-ecoinformatics-tools">Pre-Course Setup: EcoInformatics Tools<span></span></a>
<ul>
<li><a href="#pre-course-skills-setup"><span class="toc-section-number">0.1</span> Pre-Course Skills &amp; Setup<span></span></a>
<ul>
<li><a href="#installing-or-updating-r"><span class="toc-section-number">0.1.1</span> Installing or Updating R<span></span></a></li>
<li><a href="#windows-rrstudio-setup"><span class="toc-section-number">0.1.2</span> Windows R/RStudio Setup<span></span></a></li>
<li><a href="#mac-rrstudio-setup"><span class="toc-section-number">0.1.3</span> Mac R/RStudio Setup<span></span></a></li>
</ul></li>
<li><a href="#linux-rrstudio-setup"><span class="toc-section-number">0.2</span> Linux R/RStudio Setup<span></span></a>
<ul>
<li><a href="#install-basic-packages-for-this-course"><span class="toc-section-number">0.2.1</span> Install basic packages for this course<span></span></a></li>
</ul></li>
<li><a href="#installing-and-setting-up-git-github-on-your-machine"><span class="toc-section-number">0.3</span> Installing and Setting up Git &amp; Github on Your Machine<span></span></a></li>
<li><a href="#installing-atom"><span class="toc-section-number">0.4</span> Installing Atom<span></span></a></li>
<li><a href="#linking-rstudio-to-git"><span class="toc-section-number">0.5</span> Linking RStudio to Git<span></span></a></li>
<li><a href="#how-we-will-be-conducting-this-course"><span class="toc-section-number">0.6</span> How we will be Conducting this Course<span></span></a></li>
<li><a href="#exercises"><span class="toc-section-number">0.7</span> Exercises:<span></span></a></li>
<li><a href="#the-framework-of-this-course"><span class="toc-section-number">0.8</span> The Framework of this Course<span></span></a></li>
<li><a href="#final-course-project-proposed-derived-data-product"><span class="toc-section-number">0.9</span> Final Course Project: Proposed Derived Data Product<span></span></a></li>
</ul></li>
<li><a href="#introduction-to-neon-its-data"><span class="toc-section-number">1</span> Introduction to NEON &amp; its Data<span></span></a>
<ul>
<li><a href="#learning-objectives"><span class="toc-section-number">1.1</span> Learning Objectives<span></span></a></li>
<li><a href="#the-neon-project-mission-design"><span class="toc-section-number">1.2</span> The NEON Project Mission &amp; Design<span></span></a></li>
<li><a href="#the-science-and-design-of-neon"><span class="toc-section-number">1.3</span> The Science and Design of NEON<span></span></a></li>
<li><a href="#neons-spatial-design"><span class="toc-section-number">1.4</span> NEON’s Spatial Design<span></span></a>
<ul>
<li><a href="#neon-samples-all-20-eco-regions"><span class="toc-section-number">1.4.1</span> NEON Samples All 20 Eco-Regions<span></span></a></li>
</ul></li>
<li><a href="#how-neon-collects-data"><span class="toc-section-number">1.5</span> How NEON Collects Data<span></span></a>
<ul>
<li><a href="#specimens-samples"><span class="toc-section-number">1.5.1</span> Specimens &amp; Samples<span></span></a></li>
<li><a href="#airborne-remote-sensing"><span class="toc-section-number">1.5.2</span> Airborne Remote Sensing<span></span></a></li>
</ul></li>
<li><a href="#accessing-neon-data"><span class="toc-section-number">1.6</span> Accessing NEON Data<span></span></a>
<ul>
<li><a href="#pathways-to-access-neon-data"><span class="toc-section-number">1.6.1</span> Pathways to access NEON Data<span></span></a></li>
</ul></li>
<li><a href="#hands-on-accessing-neon-data-user-tokens"><span class="toc-section-number">1.7</span> Hands on: Accessing NEON Data &amp; User Tokens<span></span></a>
<ul>
<li><a href="#via-the-neon-api-with-your-user-token"><span class="toc-section-number">1.7.1</span> Via the NEON API, with your User Token<span></span></a></li>
<li><a href="#objectives"><span class="toc-section-number">1.7.2</span> Objectives<span></span></a></li>
<li><a href="#things-youll-need-to-complete-this-tutorial"><span class="toc-section-number">1.7.3</span> Things You’ll Need To Complete This Tutorial<span></span></a></li>
<li><a href="#install-r-packages"><span class="toc-section-number">1.7.4</span> Install R Packages<span></span></a></li>
</ul></li>
<li><a href="#additional-resources"><span class="toc-section-number">1.8</span> Additional Resources<span></span></a>
<ul>
<li><a href="#get-a-neon-api-token"><span class="toc-section-number">1.8.1</span> Get a NEON API Token<span></span></a></li>
<li><a href="#use-the-api-token-in-neonutilities"><span class="toc-section-number">1.8.2</span> Use the API token in neonUtilities<span></span></a></li>
<li><a href="#token-management-for-open-code"><span class="toc-section-number">1.8.3</span> Token management for open code<span></span></a></li>
</ul></li>
<li><a href="#hands-on-neon-tos-data"><span class="toc-section-number">1.9</span> Hands on: NEON TOS Data<span></span></a>
<ul>
<li><a href="#pull-in-tree-data-from-neons-tos-and-investigate-relationships"><span class="toc-section-number">1.9.1</span> Pull in Tree Data from NEON’s TOS and investigate relationships<span></span></a></li>
</ul></li>
<li><a href="#intro-to-neon-exercises-part-1"><span class="toc-section-number">1.10</span> Intro to NEON Exercises Part 1<span></span></a>
<ul>
<li><a href="#exercise-2.1-computational"><span class="toc-section-number">1.10.1</span> Exercise 2.1: Computational<span></span></a></li>
</ul></li>
<li><a href="#hands-on-pulling-neon-data-via-the-api"><span class="toc-section-number">1.11</span> Hands on: Pulling NEON Data via the API<span></span></a>
<ul>
<li><a href="#objectives-1"><span class="toc-section-number">1.11.1</span> Objectives<span></span></a></li>
<li><a href="#things-youll-need-to-complete-this-section"><span class="toc-section-number">1.11.2</span> Things You’ll Need To Complete This Section<span></span></a></li>
</ul></li>
<li><a href="#what-is-an-api"><span class="toc-section-number">1.12</span> What is an API?<span></span></a>
<ul>
<li><a href="#anatomy-of-an-api-call"><span class="toc-section-number">1.12.1</span> Anatomy of an API call<span></span></a></li>
<li><a href="#targets"><span class="toc-section-number">1.12.2</span> Targets:<span></span></a></li>
<li><a href="#observational-data-os"><span class="toc-section-number">1.12.3</span> Observational data (OS)<span></span></a></li>
<li><a href="#instrumentation-data-is"><span class="toc-section-number">1.12.4</span> Instrumentation data (IS)<span></span></a></li>
<li><a href="#remote-sensing-data-aop"><span class="toc-section-number">1.12.5</span> Remote sensing data (AOP)<span></span></a></li>
<li><a href="#geolocation-data"><span class="toc-section-number">1.12.6</span> Geolocation data<span></span></a></li>
<li><a href="#querying-a-single-named-location"><span class="toc-section-number">1.12.7</span> Querying a single named location<span></span></a></li>
<li><a href="#taxonomy"><span class="toc-section-number">1.12.8</span> Taxonomy<span></span></a></li>
</ul></li>
<li><a href="#stacking-neon-data"><span class="toc-section-number">1.13</span> Stacking NEON data<span></span></a></li>
<li><a href="#intro-to-neon-exercises-part-2"><span class="toc-section-number">1.14</span> Intro to NEON Exercises Part 2<span></span></a>
<ul>
<li><a href="#exercise-2.2-written-questions"><span class="toc-section-number">1.14.1</span> Exercise 2.2: Written questions<span></span></a></li>
<li><a href="#exercise-2.3-neon-coding-lab"><span class="toc-section-number">1.14.2</span> Exercise 2.3: NEON Coding Lab<span></span></a></li>
<li><a href="#exercise-2.4-intro-to-neon-culmination-activity"><span class="toc-section-number">1.14.3</span> Exercise 2.4: Intro to NEON Culmination Activity<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#introduction-to-usa-npn-its-data"><span class="toc-section-number">2</span> Introduction to USA-NPN &amp; its Data<span></span></a>
<ul>
<li><a href="#usa-npn-learning-objectives"><span class="toc-section-number">2.1</span> USA-NPN Learning Objectives<span></span></a></li>
<li><a href="#usa-npn-project-mission-design"><span class="toc-section-number">2.2</span> USA-NPN Project Mission &amp; Design:<span></span></a></li>
<li><a href="#vision-mission"><span class="toc-section-number">2.3</span> Vision &amp; Mission<span></span></a>
<ul>
<li><a href="#relevant-documents-background-information"><span class="toc-section-number">2.3.1</span> Relevant documents &amp; background information:<span></span></a></li>
</ul></li>
<li><a href="#usa-npns-spatial-design"><span class="toc-section-number">2.4</span> USA-NPN’s Spatial design:<span></span></a></li>
<li><a href="#types-of-usa-npn-data"><span class="toc-section-number">2.5</span> Types of USA-NPN Data:<span></span></a>
<ul>
<li><a href="#observational"><span class="toc-section-number">2.5.1</span> Observational<span></span></a></li>
<li><a href="#status-intensity-data"><span class="toc-section-number">2.5.2</span> Status &amp; Intensity Data<span></span></a></li>
<li><a href="#gridded-raster-data"><span class="toc-section-number">2.5.3</span> Gridded Raster Data<span></span></a></li>
<li><a href="#pheno-forecasts"><span class="toc-section-number">2.5.4</span> Pheno-Forecasts<span></span></a></li>
</ul></li>
<li><a href="#how-to-access-usa-npn-data"><span class="toc-section-number">2.6</span> How to Access USA-NPN Data:<span></span></a>
<ul>
<li><a href="#the-usa-npn-landing-page"><span class="toc-section-number">2.6.1</span> The USA-NPN Landing page<span></span></a></li>
<li><a href="#apis"><span class="toc-section-number">2.6.2</span> APIs<span></span></a></li>
<li><a href="#rnpn-package"><span class="toc-section-number">2.6.3</span> Rnpn package<span></span></a></li>
<li><a href="#phenology-observation-portal-for-observational-data"><span class="toc-section-number">2.6.4</span> Phenology Observation Portal (for observational data)<span></span></a></li>
<li><a href="#geospatial-request-builder-for-raster-data-and-image-files"><span class="toc-section-number">2.6.5</span> Geospatial Request Builder (for raster data and image files)<span></span></a></li>
<li><a href="#visualization-tool"><span class="toc-section-number">2.6.6</span> Visualization Tool<span></span></a></li>
</ul></li>
<li><a href="#usa-npn-written-questions"><span class="toc-section-number">2.7</span> USA-NPN Written Questions<span></span></a></li>
<li><a href="#hands-on-accessing-usa-npn-data-via-rnpn"><span class="toc-section-number">2.8</span> Hands on: Accessing USA-NPN Data via rNPN<span></span></a>
<ul>
<li><a href="#introduction"><span class="toc-section-number">2.8.1</span> Introduction<span></span></a></li>
<li><a href="#accessing-usa-npn-observational-data"><span class="toc-section-number">2.8.2</span> Accessing USA-NPN Observational Data<span></span></a></li>
<li><a href="#status-and-intensity-data"><span class="toc-section-number">2.8.3</span> Status and Intensity Data<span></span></a></li>
<li><a href="#individual-phenometrics"><span class="toc-section-number">2.8.4</span> Individual Phenometrics<span></span></a></li>
<li><a href="#site-phenometrics"><span class="toc-section-number">2.8.5</span> Site Phenometrics<span></span></a></li>
<li><a href="#magnitude-phenometrics"><span class="toc-section-number">2.8.6</span> Magnitude Phenometrics<span></span></a></li>
<li><a href="#usa-npn-geospatial-data"><span class="toc-section-number">2.8.7</span> USA-NPN Geospatial Data<span></span></a></li>
</ul></li>
<li><a href="#accumulated-growing-degree-day-products"><span class="toc-section-number">2.9</span> Accumulated Growing Degree Day Products<span></span></a></li>
<li><a href="#extended-spring-indices"><span class="toc-section-number">2.10</span> Extended Spring Indices<span></span></a>
<ul>
<li><a href="#other-layers"><span class="toc-section-number">2.10.1</span> Other Layers<span></span></a></li>
</ul></li>
<li><a href="#putting-it-all-together"><span class="toc-section-number">2.11</span> Putting it all together:<span></span></a></li>
<li><a href="#combine-point-and-raster-data"><span class="toc-section-number">2.12</span> Combine Point and Raster Data<span></span></a>
<ul>
<li><a href="#step-1-get-the-data"><span class="toc-section-number">2.12.1</span> Step 1: Get the data<span></span></a></li>
<li><a href="#step-2-preparing-the-data"><span class="toc-section-number">2.12.2</span> Step 2: Preparing the data<span></span></a></li>
<li><a href="#step-3-define-style-options-and-create-graph"><span class="toc-section-number">2.12.3</span> Step 3: Define style options and create graph<span></span></a></li>
</ul></li>
<li><a href="#live-demo-code-with-lee-marsh-of-usa-npn"><span class="toc-section-number">2.13</span> Live Demo Code with Lee Marsh of USA-NPN<span></span></a>
<ul>
<li><a href="#basic-utility-functions"><span class="toc-section-number">2.13.1</span> Basic Utility Functions<span></span></a></li>
<li><a href="#download-observational-data"><span class="toc-section-number">2.13.2</span> Download Observational Data<span></span></a></li>
<li><a href="#magnitude-data"><span class="toc-section-number">2.13.3</span> Magnitude Data<span></span></a></li>
<li><a href="#downloading-geospatial-data"><span class="toc-section-number">2.13.4</span> Downloading Geospatial Data<span></span></a></li>
<li><a href="#putting-it-together"><span class="toc-section-number">2.13.5</span> Putting it together<span></span></a></li>
<li><a href="#other-data-sources-e.g.-daymet-modis"><span class="toc-section-number">2.13.6</span> Other Data Sources, e.g. Daymet, MODIS<span></span></a></li>
</ul></li>
<li><a href="#usa-npn-coding-lab"><span class="toc-section-number">2.14</span> USA-NPN Coding Lab<span></span></a></li>
<li><a href="#neon-tos-phenology-data-lecture"><span class="toc-section-number">2.15</span> NEON TOS Phenology Data Lecture<span></span></a></li>
<li><a href="#understanding-observation-biases-and-censoring-in-citizen-science-data"><span class="toc-section-number">2.16</span> Understanding Observation Biases and Censoring in Citizen Science Data<span></span></a>
<ul>
<li><a href="#many-existing-modeling-approaches-fail-in-one-or-both-regards."><span class="toc-section-number">2.16.1</span> Many existing modeling approaches fail in one (or both) regards.<span></span></a></li>
<li><a href="#censoring"><span class="toc-section-number">2.16.2</span> Censoring<span></span></a></li>
</ul></li>
<li><a href="#so-then-how-can-we-model-censored-data"><span class="toc-section-number">2.17</span> So then how can we model censored data?<span></span></a></li>
<li><a href="#intro-to-usa-npn-culmination-activity"><span class="toc-section-number">2.18</span> Intro to USA-NPN Culmination Activity<span></span></a></li>
</ul></li>
<li><a href="#phenocam-digital-repeat-photography-networks-methods"><span class="toc-section-number">3</span> PhenoCam: Digital Repeat Photography Networks &amp; Methods<span></span></a>
<ul>
<li><a href="#digital-repeat-photography-networks-learning-objectives"><span class="toc-section-number">3.1</span> Digital Repeat Photography Networks Learning Objectives<span></span></a></li>
<li><a href="#the-phenocam-network-mission-design"><span class="toc-section-number">3.2</span> The PhenoCam Network Mission &amp; Design<span></span></a>
<ul>
<li><a href="#relevant-documents-background-information-1"><span class="toc-section-number">3.2.1</span> Relevant documents &amp; background information:<span></span></a></li>
</ul></li>
<li><a href="#phenocams-spatial-design"><span class="toc-section-number">3.3</span> PhenoCam’s Spatial design:<span></span></a>
<ul>
<li><a href="#phenocam-as-a-near-surface-remote-sensing-technique"><span class="toc-section-number">3.3.1</span> PhenoCam as a Near Surface Remote Sensing Technique<span></span></a></li>
<li><a href="#how-phenocams-pull-data"><span class="toc-section-number">3.3.2</span> How PhenoCams Pull Data<span></span></a></li>
<li><a href="#leveraging-camera-near-infrared-nir-capabilities"><span class="toc-section-number">3.3.3</span> Leveraging camera near-infrared (NIR) capabilities<span></span></a></li>
</ul></li>
<li><a href="#digital-repeat-photography-written-questions"><span class="toc-section-number">3.4</span> Digital Repeat Photography Written Questions<span></span></a></li>
<li><a href="#introduction-to-digital-repeat-photography-methods"><span class="toc-section-number">3.5</span> Introduction to Digital Repeat Photography Methods<span></span></a></li>
<li><a href="#pulling-data-via-the-phenocamapi-package"><span class="toc-section-number">3.6</span> Pulling Data via the <em>phenocamapi</em> Package<span></span></a></li>
<li><a href="#exploring-phenocam-metadata"><span class="toc-section-number">3.7</span> Exploring PhenoCam metadata<span></span></a>
<ul>
<li><a href="#remove-null-values"><span class="toc-section-number">3.7.1</span> Remove null values<span></span></a></li>
<li><a href="#filtering-using-attributes"><span class="toc-section-number">3.7.2</span> Filtering using attributes<span></span></a></li>
</ul></li>
<li><a href="#download-midday-images"><span class="toc-section-number">3.8</span> Download midday images<span></span></a>
<ul>
<li><a href="#download-midday-images-for-a-given-time-range"><span class="toc-section-number">3.8.1</span> Download midday images for a given time range<span></span></a></li>
</ul></li>
<li><a href="#detecting-foggy-images-using-the-hazer-r-package"><span class="toc-section-number">3.9</span> Detecting Foggy Images using the ‘hazer’ R Package<span></span></a></li>
<li><a href="#extracting-timeseries-from-images-using-the-xroi-r-package"><span class="toc-section-number">3.10</span> Extracting Timeseries from Images using the xROI R Package<span></span></a>
<ul>
<li><a href="#xroi-design"><span class="toc-section-number">3.10.1</span> xROI Design<span></span></a></li>
<li><a href="#install-xroi"><span class="toc-section-number">3.10.2</span> Install xROI<span></span></a></li>
<li><a href="#launch-xroi"><span class="toc-section-number">3.10.3</span> Launch xROI<span></span></a></li>
<li><a href="#end-xroi"><span class="toc-section-number">3.10.4</span> End xROI<span></span></a></li>
<li><a href="#use-xroi"><span class="toc-section-number">3.10.5</span> Use xROI<span></span></a></li>
</ul></li>
<li><a href="#documentation-and-citation"><span class="toc-section-number">3.11</span> Documentation and Citation<span></span></a>
<ul>
<li><a href="#challenge-use-xroi"><span class="toc-section-number">3.11.1</span> Challenge: Use xROI<span></span></a></li>
</ul></li>
<li><a href="#hands-on-digital-repeat-photography-computational"><span class="toc-section-number">3.12</span> Hands on: Digital Repeat Photography Computational<span></span></a>
<ul>
<li><a href="#phenocam-time-series"><span class="toc-section-number">3.12.1</span> PhenoCam time series<span></span></a></li>
<li><a href="#obtain-rois"><span class="toc-section-number">3.12.2</span> Obtain ROIs<span></span></a></li>
<li><a href="#download-time-series"><span class="toc-section-number">3.12.3</span> Download time series<span></span></a></li>
<li><a href="#threshold-values"><span class="toc-section-number">3.12.4</span> Threshold values<span></span></a></li>
<li><a href="#comparing-phenology-across-vegetation-types"><span class="toc-section-number">3.12.5</span> Comparing phenology across vegetation types<span></span></a></li>
<li><a href="#in-class-hands-on-coding-comparing-phenology-of-the-same-plant-function-type-pft-across-climate-space"><span class="toc-section-number">3.12.6</span> In Class Hands-on Coding: Comparing phenology of the same plant function type (PFT) across climate space<span></span></a></li>
</ul></li>
<li><a href="#digital-repeat-photography-coding-lab"><span class="toc-section-number">3.13</span> Digital Repeat Photography Coding Lab<span></span></a>
<ul>
<li><a href="#quantifying-haze-and-redness-to-evaluate-california-wildfires"><span class="toc-section-number">3.13.1</span> Quantifying haze and redness to evaluate California wildfires<span></span></a></li>
</ul></li>
<li><a href="#phenocam-culmination-activity"><span class="toc-section-number">3.14</span> PhenoCam Culmination Activity<span></span></a></li>
</ul></li>
<li><a href="#flux-measurements-inter-operability"><span class="toc-section-number">4</span> Flux Measurements &amp; Inter-Operability<span></span></a>
<ul>
<li><a href="#learning-objectives-1"><span class="toc-section-number">4.1</span> Learning Objectives<span></span></a></li>
<li><a href="#eddy-co_variance-data-what-does-it-actually-measure"><span class="toc-section-number">4.2</span> Eddy Co_variance Data: What does it actually measure?<span></span></a>
<ul>
<li><a href="#example-eddy-site"><span class="toc-section-number">4.2.1</span> Example Eddy Site<span></span></a></li>
</ul></li>
<li><a href="#qaqc-flags"><span class="toc-section-number">4.3</span> QA/QC Flags<span></span></a></li>
<li><a href="#examples-of-other-flux-networks-ameriflux-fluxnet"><span class="toc-section-number">4.4</span> Examples of Other Flux Networks: AMERIFLUX &amp; FLUXNET<span></span></a></li>
<li><a href="#the-power-of-networked-ecology-bridging-to-ameriflux-and-beyond"><span class="toc-section-number">4.5</span> The Power of Networked Ecology: Bridging to AMERIFLUX and Beyond<span></span></a></li>
<li><a href="#hands-on-introduction-to-working-with-neon-eddy-flux-data"><span class="toc-section-number">4.6</span> Hands On: Introduction to working with NEON eddy flux data<span></span></a>
<ul>
<li><a href="#setup"><span class="toc-section-number">4.6.1</span> Setup<span></span></a></li>
<li><a href="#data-levels"><span class="toc-section-number">4.6.2</span> Data Levels<span></span></a></li>
<li><a href="#extract-level-4-data-fluxes"><span class="toc-section-number">4.6.3</span> Extract Level 4 data (Fluxes!)<span></span></a></li>
<li><a href="#time-stamps"><span class="toc-section-number">4.6.4</span> Time stamps<span></span></a></li>
<li><a href="#merge-flux-data-with-other-sensor-data"><span class="toc-section-number">4.6.5</span> Merge flux data with other sensor data<span></span></a></li>
<li><a href="#vertical-profile-data-level-3"><span class="toc-section-number">4.6.6</span> Vertical profile data (Level 3)<span></span></a></li>
<li><a href="#un-interpolated-vertical-profile-data-level-2"><span class="toc-section-number">4.6.7</span> Un-interpolated vertical profile data (Level 2)<span></span></a></li>
<li><a href="#calibrated-raw-data-level-1"><span class="toc-section-number">4.6.8</span> Calibrated raw data (Level 1)<span></span></a></li>
<li><a href="#convert-neon-flux-data-variables-to-ameriflux-fp-standard"><span class="toc-section-number">4.6.9</span> Convert NEON flux data variables to AmeriFlux FP standard<span></span></a></li>
</ul></li>
<li><a href="#exercises-1"><span class="toc-section-number">4.7</span> Exercises<span></span></a>
<ul>
<li><a href="#computational"><span class="toc-section-number">4.7.1</span> Computational<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#neon-aop"><span class="toc-section-number">5</span> NEON AOP<span></span></a>
<ul>
<li><a href="#hyperspectral-remote-sensing"><span class="toc-section-number">5.1</span> Hyperspectral Remote Sensing<span></span></a>
<ul>
<li><a href="#learning-objectives-2"><span class="toc-section-number">5.1.1</span> Learning Objectives<span></span></a></li>
<li><a href="#about-hyperspectral-remote-sensing-data"><span class="toc-section-number">5.1.2</span> About Hyperspectral Remote Sensing Data<span></span></a></li>
</ul></li>
<li><a href="#key-metadata-for-hyperspectral-data"><span class="toc-section-number">5.2</span> Key Metadata for Hyperspectral Data<span></span></a>
<ul>
<li><a href="#bands-and-wavelengths"><span class="toc-section-number">5.2.1</span> Bands and Wavelengths<span></span></a></li>
<li><a href="#spectral-resolution"><span class="toc-section-number">5.2.2</span> Spectral Resolution<span></span></a></li>
<li><a href="#full-width-half-max-fwhm"><span class="toc-section-number">5.2.3</span> Full Width Half Max (FWHM)<span></span></a></li>
</ul></li>
<li><a href="#intro-to-working-with-hyperspectral-remote-sensing-data-in-hdf5-format"><span class="toc-section-number">5.3</span> Intro to Working with Hyperspectral Remote Sensing Data in HDF5 Format<span></span></a>
<ul>
<li><a href="#learning-objectives-3"><span class="toc-section-number">5.3.1</span> Learning Objectives<span></span></a></li>
<li><a href="#r-libraries-to-install"><span class="toc-section-number">5.3.2</span> R Libraries to Install:<span></span></a></li>
<li><a href="#data-to-download"><span class="toc-section-number">5.3.3</span> Data to Download<span></span></a></li>
</ul></li>
<li><a href="#about-hyperspectral-remote-sensing-data-1"><span class="toc-section-number">5.4</span> About Hyperspectral Remote Sensing Data<span></span></a></li>
<li><a href="#read-hdf5-data-into-r"><span class="toc-section-number">5.5</span> Read HDF5 data into R<span></span></a>
<ul>
<li><a href="#bands-and-wavelengths-1"><span class="toc-section-number">5.5.1</span> Bands and Wavelengths<span></span></a></li>
<li><a href="#a-note-about-data-slicing-in-hdf5"><span class="toc-section-number">5.5.2</span> A Note About Data Slicing in HDF5<span></span></a></li>
<li><a href="#arrays-vs.-matrices"><span class="toc-section-number">5.5.3</span> Arrays vs. Matrices<span></span></a></li>
<li><a href="#dimensions-in-arrays"><span class="toc-section-number">5.5.4</span> Dimensions in Arrays<span></span></a></li>
<li><a href="#data-ignore-value"><span class="toc-section-number">5.5.5</span> Data Ignore Value<span></span></a></li>
<li><a href="#reflectance-values-and-image-stretch"><span class="toc-section-number">5.5.6</span> Reflectance Values and Image Stretch<span></span></a></li>
<li><a href="#transpose-image"><span class="toc-section-number">5.5.7</span> Transpose Image<span></span></a></li>
</ul></li>
<li><a href="#create-a-georeferenced-raster"><span class="toc-section-number">5.6</span> Create a Georeferenced Raster<span></span></a>
<ul>
<li><a href="#define-raster-crs"><span class="toc-section-number">5.6.1</span> Define Raster CRS<span></span></a></li>
<li><a href="#challenge-work-with-rasters"><span class="toc-section-number">5.6.2</span> Challenge: Work with Rasters<span></span></a></li>
</ul></li>
<li><a href="#light-detection-and-ranging-lidar-data"><span class="toc-section-number">5.7</span> Light Detection And Ranging (LiDAR) Data<span></span></a></li>
<li><a href="#calculating-forest-structural-diversity-metrics-from-neon-lidar-data"><span class="toc-section-number">5.8</span> Calculating Forest Structural Diversity Metrics from NEON LiDAR Data<span></span></a>
<ul>
<li><a href="#learning-objectives-4"><span class="toc-section-number">5.8.1</span> Learning Objectives<span></span></a></li>
<li><a href="#r-libraries-to-install-1"><span class="toc-section-number">5.8.2</span> R Libraries to Install:<span></span></a></li>
<li><a href="#data-to-download-1"><span class="toc-section-number">5.8.3</span> Data to Download<span></span></a></li>
<li><a href="#recommended-skills"><span class="toc-section-number">5.8.4</span> Recommended Skills<span></span></a></li>
<li><a href="#additional-resources-2"><span class="toc-section-number">5.8.5</span> Additional Resources<span></span></a></li>
</ul></li>
<li><a href="#introduction-to-structural-diversity-metrics"><span class="toc-section-number">5.9</span> Introduction to Structural Diversity Metrics<span></span></a></li>
<li><a href="#neon-aop-discrete-return-lidar"><span class="toc-section-number">5.10</span> NEON AOP Discrete Return LIDAR<span></span></a>
<ul>
<li><a href="#loading-the-lidar-products"><span class="toc-section-number">5.10.1</span> Loading the LIDAR Products<span></span></a></li>
<li><a href="#normalizing-tree-height-to-ground"><span class="toc-section-number">5.10.2</span> Normalizing Tree Height to Ground<span></span></a></li>
</ul></li>
<li><a href="#calculating-structural-diversity-metrics"><span class="toc-section-number">5.11</span> Calculating Structural Diversity Metrics<span></span></a>
<ul>
<li><a href="#generate-canopy-height-model-chm"><span class="toc-section-number">5.11.1</span> GENERATE CANOPY HEIGHT MODEL (CHM)<span></span></a></li>
<li><a href="#combining-everything-into-one-function"><span class="toc-section-number">5.11.2</span> Combining Everything Into One Function<span></span></a></li>
<li><a href="#comparing-metrics-between-forests"><span class="toc-section-number">5.11.3</span> Comparing Metrics Between Forests<span></span></a></li>
</ul></li>
<li><a href="#matching-gedi-waveforms-with-neon-aop-lidar-pointclouds"><span class="toc-section-number">5.12</span> Matching GEDI waveforms with NEON AOP LiDAR pointclouds<span></span></a>
<ul>
<li><a href="#learning-objectives-5"><span class="toc-section-number">5.12.1</span> Learning Objectives<span></span></a></li>
<li><a href="#things-youll-need-to-complete-this-gedi-section"><span class="toc-section-number">5.12.2</span> Things You’ll Need To Complete This GEDI Section<span></span></a></li>
<li><a href="#r-packages-to-install"><span class="toc-section-number">5.12.3</span> R Packages to Install<span></span></a></li>
<li><a href="#example-data-set"><span class="toc-section-number">5.12.4</span> Example Data Set<span></span></a></li>
<li><a href="#getting-started"><span class="toc-section-number">5.12.5</span> Getting Started<span></span></a></li>
<li><a href="#downloading-gedi-data"><span class="toc-section-number">5.12.6</span> Downloading GEDI data<span></span></a></li>
<li><a href="#plot-gedi-footprints-on-chm"><span class="toc-section-number">5.12.7</span> Plot GEDI footprints on CHM<span></span></a></li>
<li><a href="#extract-waveform-for-a-single-shot"><span class="toc-section-number">5.12.8</span> Extract Waveform for a single Shot<span></span></a></li>
<li><a href="#download-and-plot-neon-aop-lidar-pointcloud-data"><span class="toc-section-number">5.12.9</span> Download and Plot NEON AOP LiDAR pointcloud data<span></span></a></li>
<li><a href="#clip-aop-lidar-pointcloud-to-gedi-footprints"><span class="toc-section-number">5.12.10</span> Clip AOP LiDAR Pointcloud to GEDI footprints<span></span></a></li>
<li><a href="#plot-gedi-waveform-with-aop-pointcloud-in-3d-space"><span class="toc-section-number">5.12.11</span> Plot GEDI Waveform with AOP Pointcloud in 3D space<span></span></a></li>
<li><a href="#datum-geoid-and-how-to-best-measure-the-earth"><span class="toc-section-number">5.12.12</span> Datum, Geoid, and how to best measure the Earth<span></span></a></li>
<li><a href="#aligning-the-vertical-datum"><span class="toc-section-number">5.12.13</span> Aligning the Vertical Datum<span></span></a></li>
<li><a href="#geoid12a-height-model"><span class="toc-section-number">5.12.14</span> GEOID12A Height Model<span></span></a></li>
<li><a href="#extract-vertical-offset-for-gedi-shots"><span class="toc-section-number">5.12.15</span> Extract vertical offset for GEDI shots<span></span></a></li>
<li><a href="#plot-vertically-corrected-gedi-waveform-in-3d"><span class="toc-section-number">5.12.16</span> Plot vertically corrected GEDI waveform in 3D<span></span></a></li>
<li><a href="#optional---neon-base-plots"><span class="toc-section-number">5.12.17</span> Optional - NEON base plots<span></span></a></li>
</ul></li>
<li><a href="#neon-aop-written-questions"><span class="toc-section-number">5.13</span> NEON AOP Written Questions:<span></span></a></li>
<li><a href="#neon-aop-coding-lab"><span class="toc-section-number">5.14</span> NEON AOP Coding Lab<span></span></a></li>
<li><a href="#neon-aop-culmination-write-up"><span class="toc-section-number">5.15</span> NEON AOP Culmination Write Up<span></span></a></li>
</ul></li>
<li><a href="#nasas-earth-observing-system-eos"><span class="toc-section-number">6</span> NASA’s Earth Observing System (EOS)<span></span></a>
<ul>
<li><a href="#learning-objectives-6"><span class="toc-section-number">6.1</span> Learning Objectives<span></span></a></li>
<li><a href="#nasa-eos-project-mission-design"><span class="toc-section-number">6.2</span> NASA EOS Project Mission &amp; Design<span></span></a></li>
<li><a href="#nasa-eos-earth-data-account"><span class="toc-section-number">6.3</span> NASA EOS Earth Data Account:<span></span></a></li>
<li><a href="#nasa-eos-coding-assignment-1"><span class="toc-section-number">6.4</span> <strong>NASA EOS Coding Assignment 1</strong><span></span></a></li>
<li><a href="#distributed-active-archive-centers"><span class="toc-section-number">6.5</span> Distributed Active Archive Centers<span></span></a>
<ul>
<li><a href="#lp-daac"><span class="toc-section-number">6.5.1</span> LP DAAC<span></span></a></li>
</ul></li>
<li><a href="#the-lpdaac-mission-process-archive-distribute-apply"><span class="toc-section-number">6.6</span> The LPDAAC Mission: Process, Archive, Distribute, Apply<span></span></a>
<ul>
<li><a href="#how-you-can-use-lp-daacs-data"><span class="toc-section-number">6.6.1</span> How you can use LP DAAC’s data<span></span></a></li>
</ul></li>
<li><a href="#appeears"><span class="toc-section-number">6.7</span> AppEEARS<span></span></a></li>
<li><a href="#hands-on-pulling-appeears-data-via-the-api"><span class="toc-section-number">6.8</span> Hands on: Pulling AppEEARS Data via the API<span></span></a></li>
<li><a href="#getting-started-with-the-appeears-api-point-request"><span class="toc-section-number">6.9</span> Getting Started with the AppEEARS API (Point Request)<span></span></a>
<ul>
<li><a href="#example-submit-a-point-request-for-multiple-neon-sites-to-extract-vegetation-and-land-surface-temperature-data"><span class="toc-section-number">6.9.1</span> Example: Submit a point request for multiple NEON sites to extract vegetation and land surface temperature data<span></span></a></li>
</ul></li>
<li><a href="#topics-covered-in-this-section"><span class="toc-section-number">6.10</span> Topics Covered in this section:<span></span></a>
<ul>
<li><a href="#prerequisites"><span class="toc-section-number">6.10.1</span> Prerequisites:<span></span></a></li>
<li><a href="#appeears-information"><span class="toc-section-number">6.10.2</span> AppEEARS Information:<span></span></a></li>
</ul></li>
<li><a href="#getting-started-with-the-appeears-api"><span class="toc-section-number">6.11</span> Getting Started with the AppEEARS API<span></span></a>
<ul>
<li><a href="#load-packages"><span class="toc-section-number">6.11.1</span> Load Packages<span></span></a></li>
<li><a href="#set-up-the-output-directory"><span class="toc-section-number">6.11.2</span> Set Up the Output Directory<span></span></a></li>
<li><a href="#login-to-earth-data"><span class="toc-section-number">6.11.3</span> Login to Earth Data<span></span></a></li>
</ul></li>
<li><a href="#query-available-products"><span class="toc-section-number">6.12</span> Query Available Products<span></span></a></li>
<li><a href="#search-and-explore-available-products"><span class="toc-section-number">6.13</span> Search and Explore Available Products<span></span></a></li>
<li><a href="#search-and-explore-available-layers"><span class="toc-section-number">6.14</span> Search and Explore Available Layers<span></span></a></li>
<li><a href="#submit-a-point-request"><span class="toc-section-number">6.15</span> Submit a Point Request<span></span></a>
<ul>
<li><a href="#compile-a-json-object"><span class="toc-section-number">6.15.1</span> Compile a JSON Object<span></span></a></li>
<li><a href="#submit-a-task-request"><span class="toc-section-number">6.15.2</span> Submit a Task Request<span></span></a></li>
<li><a href="#retrieve-task-status"><span class="toc-section-number">6.15.3</span> Retrieve Task Status<span></span></a></li>
</ul></li>
<li><a href="#download-a-request"><span class="toc-section-number">6.16</span> Download a Request<span></span></a>
<ul>
<li><a href="#explore-files-in-request-output"><span class="toc-section-number">6.16.1</span> Explore Files in Request Output<span></span></a></li>
</ul></li>
<li><a href="#download-files-in-a-request-automation"><span class="toc-section-number">6.17</span> Download Files in a Request (Automation)<span></span></a></li>
<li><a href="#explore-appeears-quality-service"><span class="toc-section-number">6.18</span> Explore AppEEARS Quality Service<span></span></a>
<ul>
<li><a href="#list-quality-layers"><span class="toc-section-number">6.18.1</span> List Quality Layers<span></span></a></li>
<li><a href="#inspect-quality-values"><span class="toc-section-number">6.18.2</span> Inspect Quality Values<span></span></a></li>
</ul></li>
<li><a href="#decode-quality-values"><span class="toc-section-number">6.19</span> Decode Quality Values<span></span></a></li>
<li><a href="#load-request-output-and-visualize"><span class="toc-section-number">6.20</span> Load Request Output and Visualize<span></span></a></li>
<li><a href="#load-a-csv"><span class="toc-section-number">6.21</span> Load a CSV<span></span></a></li>
<li><a href="#plot-results-linescatter-plots"><span class="toc-section-number">6.22</span> Plot Results (Line/Scatter Plots)<span></span></a></li>
<li><a href="#submit-an-area-request"><span class="toc-section-number">6.23</span> Submit an Area Request<span></span></a></li>
<li><a href="#submit-an-area-request-using-a-neon-site-boundary-as-the-region-of-interest-for-extracting-elevation-vegetation-and-land-surface-temperature-data"><span class="toc-section-number">6.24</span> Submit an area request using a NEON site boundary as the region of interest for extracting elevation, vegetation and land surface temperature data<span></span></a>
<ul>
<li><a href="#topics-covered-in-this-tutorial"><span class="toc-section-number">6.24.1</span> Topics Covered in this Tutorial<span></span></a></li>
<li><a href="#prerequisites-1"><span class="toc-section-number">6.24.2</span> Prerequisites:<span></span></a></li>
<li><a href="#procedures"><span class="toc-section-number">6.24.3</span> Procedures:<span></span></a></li>
<li><a href="#appeears-information-1"><span class="toc-section-number">6.24.4</span> AppEEARS Information:<span></span></a></li>
</ul></li>
<li><a href="#getting-started-with-an-area-request"><span class="toc-section-number">6.25</span> Getting Started with an Area Request<span></span></a>
<ul>
<li><a href="#load-packages-for-an-area-request"><span class="toc-section-number">6.25.1</span> Load Packages for an Area Request<span></span></a></li>
</ul></li>
<li><a href="#set-up-the-output-directory-1"><span class="toc-section-number">6.26</span> Set Up the Output Directory<span></span></a></li>
<li><a href="#load-your-earth-data-token"><span class="toc-section-number">6.27</span> Load your Earth Data Token<span></span></a></li>
<li><a href="#query-available-products-1"><span class="toc-section-number">6.28</span> Query Available Products<span></span></a></li>
<li><a href="#search-and-explore-available-products-1"><span class="toc-section-number">6.29</span> Search and Explore Available Products<span></span></a></li>
<li><a href="#search-and-explore-available-layers-1"><span class="toc-section-number">6.30</span> Search and Explore Available Layers<span></span></a></li>
<li><a href="#submit-an-area-request-1"><span class="toc-section-number">6.31</span> Submit an Area Request<span></span></a>
<ul>
<li><a href="#load-a-shapefile"><span class="toc-section-number">6.31.1</span> Load a Shapefile<span></span></a></li>
</ul></li>
<li><a href="#search-and-explore-available-projections"><span class="toc-section-number">6.32</span> Search and Explore Available Projections<span></span></a></li>
<li><a href="#compile-a-json-object-1"><span class="toc-section-number">6.33</span> Compile a JSON Object<span></span></a></li>
<li><a href="#submit-a-task-request-1"><span class="toc-section-number">6.34</span> Submit a Task Request<span></span></a></li>
<li><a href="#retrieve-task-status-1"><span class="toc-section-number">6.35</span> Retrieve Task Status<span></span></a></li>
<li><a href="#download-a-request-1"><span class="toc-section-number">6.36</span> Download a Request<span></span></a>
<ul>
<li><a href="#explore-files-in-request-output-1"><span class="toc-section-number">6.36.1</span> Explore Files in Request Output<span></span></a></li>
</ul></li>
<li><a href="#download-files-in-a-request-automation-1"><span class="toc-section-number">6.37</span> Download Files in a Request (Automation)<span></span></a></li>
<li><a href="#explore-appeears-quality-service-1"><span class="toc-section-number">6.38</span> Explore AppEEARS Quality Service<span></span></a></li>
<li><a href="#list-quality-layers-1"><span class="toc-section-number">6.39</span> List Quality Layers<span></span></a></li>
<li><a href="#show-quality-values"><span class="toc-section-number">6.40</span> Show Quality Values<span></span></a></li>
<li><a href="#decode-quality-values-1"><span class="toc-section-number">6.41</span> Decode Quality Values<span></span></a></li>
<li><a href="#bonus-load-request-output-and-visualize"><span class="toc-section-number">6.42</span> BONUS: Load Request Output and Visualize<span></span></a></li>
<li><a href="#load-a-geotiff"><span class="toc-section-number">6.43</span> Load a GeoTIFF<span></span></a></li>
<li><a href="#plot-a-geotiff"><span class="toc-section-number">6.44</span> Plot a GeoTIFF<span></span></a></li>
<li><a href="#nasa-eos-coding-lab-2"><span class="toc-section-number">6.45</span> NASA EOS Coding Lab #2<span></span></a></li>
<li><a href="#nasa-eos-written-questions"><span class="toc-section-number">6.46</span> NASA EOS Written Questions<span></span></a></li>
<li><a href="#nasa-eos-culmination-write-up"><span class="toc-section-number">6.47</span> NASA EOS Culmination Write Up<span></span></a></li>
</ul></li>
<li><a href="#usgs-national-water-information-system-nwis"><span class="toc-section-number">7</span> USGS National Water Information System (NWIS)<span></span></a>
<ul>
<li><a href="#usgs-mission"><span class="toc-section-number">7.1</span> USGS Mission:<span></span></a></li>
<li><a href="#usgs-water-resources-mission"><span class="toc-section-number">7.2</span> USGS Water Resources Mission:<span></span></a></li>
<li><a href="#types-of-usgs-nwis-data"><span class="toc-section-number">7.3</span> Types of USGS NWIS Data<span></span></a></li>
<li><a href="#usgs-r-packages-collaborative-and-reproducible-data-analysis-using-r"><span class="toc-section-number">7.4</span> USGS R Packages: Collaborative and reproducible data analysis using R<span></span></a>
<ul>
<li><a href="#suggested-prerequisite-knowledge"><span class="toc-section-number">7.4.1</span> Suggested prerequisite knowledge<span></span></a></li>
<li><a href="#course-outline"><span class="toc-section-number">7.4.2</span> Course outline<span></span></a></li>
<li><a href="#software-requirements"><span class="toc-section-number">7.4.3</span> Software requirements<span></span></a></li>
<li><a href="#lesson-summary"><span class="toc-section-number">7.4.4</span> Lesson Summary<span></span></a></li>
<li><a href="#lesson-objectives"><span class="toc-section-number">7.4.5</span> Lesson Objectives<span></span></a></li>
<li><a href="#lesson-resources"><span class="toc-section-number">7.4.6</span> Lesson Resources<span></span></a></li>
<li><a href="#lesson-slide-deck"><span class="toc-section-number">7.4.7</span> Lesson Slide Deck<span></span></a></li>
</ul></li>
<li><a href="#introduction-to-usgs-r-packages"><span class="toc-section-number">7.5</span> Introduction to USGS R Packages<span></span></a></li>
<li><a href="#data-available"><span class="toc-section-number">7.6</span> Data available<span></span></a></li>
<li><a href="#common-nwis-function-arguments"><span class="toc-section-number">7.7</span> Common NWIS function arguments<span></span></a></li>
<li><a href="#discovering-nwis-data"><span class="toc-section-number">7.8</span> Discovering NWIS data<span></span></a>
<ul>
<li><a href="#whatnwisdata"><span class="toc-section-number">7.8.1</span> whatNWISdata<span></span></a></li>
</ul></li>
<li><a href="#common-wqp-function-arguments"><span class="toc-section-number">7.9</span> Common WQP function arguments<span></span></a></li>
<li><a href="#discovering-wqp-data"><span class="toc-section-number">7.10</span> Discovering WQP data<span></span></a>
<ul>
<li><a href="#readwqpdata-querysummary"><span class="toc-section-number">7.10.1</span> readWQPdata + querySummary<span></span></a></li>
<li><a href="#whatwqpsites"><span class="toc-section-number">7.10.2</span> whatWQPsites<span></span></a></li>
</ul></li>
<li><a href="#readnwis-functions"><span class="toc-section-number">7.11</span> readNWIS functions<span></span></a>
<ul>
<li><a href="#readnwisdata"><span class="toc-section-number">7.11.1</span> readNWISdata<span></span></a></li>
<li><a href="#readnwisdv"><span class="toc-section-number">7.11.2</span> readNWISdv<span></span></a></li>
<li><a href="#readnwisgwl"><span class="toc-section-number">7.11.3</span> readNWISgwl<span></span></a></li>
<li><a href="#readnwismeas"><span class="toc-section-number">7.11.4</span> readNWISmeas<span></span></a></li>
<li><a href="#readnwispcode"><span class="toc-section-number">7.11.5</span> readNWISpCode<span></span></a></li>
<li><a href="#readnwispeak"><span class="toc-section-number">7.11.6</span> readNWISpeak<span></span></a></li>
<li><a href="#readnwisqw"><span class="toc-section-number">7.11.7</span> readNWISqw<span></span></a></li>
<li><a href="#readnwisrating"><span class="toc-section-number">7.11.8</span> readNWISrating<span></span></a></li>
<li><a href="#readnwissite"><span class="toc-section-number">7.11.9</span> readNWISsite<span></span></a></li>
<li><a href="#readnwisstat"><span class="toc-section-number">7.11.10</span> readNWISstat<span></span></a></li>
<li><a href="#readnwisuse"><span class="toc-section-number">7.11.11</span> readNWISuse<span></span></a></li>
<li><a href="#readnwisuv"><span class="toc-section-number">7.11.12</span> readNWISuv<span></span></a></li>
</ul></li>
<li><a href="#additional-features"><span class="toc-section-number">7.12</span> Additional Features<span></span></a>
<ul>
<li><a href="#accessing-attributes"><span class="toc-section-number">7.12.1</span> Accessing attributes<span></span></a></li>
<li><a href="#using-lists-as-input"><span class="toc-section-number">7.12.2</span> Using lists as input<span></span></a></li>
<li><a href="#helper-functions"><span class="toc-section-number">7.12.3</span> Helper functions<span></span></a></li>
</ul></li>
<li><a href="#readwqp-functions"><span class="toc-section-number">7.13</span> readWQP functions<span></span></a>
<ul>
<li><a href="#readwqpdata"><span class="toc-section-number">7.13.1</span> readWQPdata<span></span></a></li>
<li><a href="#readwqpqw"><span class="toc-section-number">7.13.2</span> readWQPqw<span></span></a></li>
</ul></li>
<li><a href="#attributes-and-metadata"><span class="toc-section-number">7.14</span> Attributes and metadata<span></span></a></li>
<li><a href="#usgs-coding-lab-exercises"><span class="toc-section-number">7.15</span> USGS Coding Lab Exercises<span></span></a>
<ul>
<li><a href="#just-how-dry-was-the-2020-monsoon"><span class="toc-section-number">7.15.1</span> Just how dry was the 2020 monsoon?<span></span></a></li>
</ul></li>
<li><a href="#geoknife---introduction"><span class="toc-section-number">7.16</span> geoKnife - Introduction<span></span></a></li>
<li><a href="#lesson-summary-1"><span class="toc-section-number">7.17</span> Lesson Summary<span></span></a></li>
<li><a href="#lesson-objectives-1"><span class="toc-section-number">7.18</span> Lesson Objectives<span></span></a></li>
<li><a href="#lesson-resources-1"><span class="toc-section-number">7.19</span> Lesson Resources<span></span></a></li>
<li><a href="#remote-processing"><span class="toc-section-number">7.20</span> Remote processing<span></span></a></li>
<li><a href="#geoknife-components-fabric-stencil-knife"><span class="toc-section-number">7.21</span> geoknife components: fabric, stencil, knife<span></span></a></li>
<li><a href="#available-webdata"><span class="toc-section-number">7.22</span> Available webdata<span></span></a>
<ul>
<li><a href="#gdp-datasets"><span class="toc-section-number">7.22.1</span> GDP datasets<span></span></a></li>
<li><a href="#datasets-not-in-gdp"><span class="toc-section-number">7.22.2</span> Datasets not in GDP<span></span></a></li>
</ul></li>
<li><a href="#available-webgeoms"><span class="toc-section-number">7.23</span> Available webgeoms<span></span></a></li>
<li><a href="#available-webprocesses"><span class="toc-section-number">7.24</span> Available webprocesses<span></span></a></li>
<li><a href="#setting-up-a-geojob"><span class="toc-section-number">7.25</span> Setting up a geojob<span></span></a></li>
<li><a href="#checking-the-geojob-status"><span class="toc-section-number">7.26</span> Checking the geojob status<span></span></a></li>
<li><a href="#getting-geojob-data"><span class="toc-section-number">7.27</span> Getting geojob data<span></span></a></li>
<li><a href="#wait-and-email"><span class="toc-section-number">7.28</span> <code>wait</code> and <code>email</code><span></span></a></li>
<li><a href="#putting-it-all-together-mapping-precipitation-from-tropical-storm-colin"><span class="toc-section-number">7.29</span> Putting it all together, mapping precipitation from Tropical Storm Colin<span></span></a></li>
<li><a href="#usgs-nwis-culmination-write-up"><span class="toc-section-number">7.30</span> USGS NWIS Culmination Write Up<span></span></a></li>
</ul></li>
<li><a href="#frequently-asked-questions">Frequently Asked Questions:<span></span></a>
<ul>
<li><a href="#where-can-i-find-due-dates-for-assignments"><span class="toc-section-number">7.31</span> Where can I find due dates for assignments?<span></span></a></li>
<li><a href="#how-do-i-submit-assignments"><span class="toc-section-number">7.32</span> How do I submit assignments?<span></span></a></li>
<li><a href="#do-i-still-have-to-submit-written-exercises-as-.rmd-and-.pdf"><span class="toc-section-number">7.33</span> Do I still have to submit written exercises as .Rmd and .pdf?<span></span></a></li>
<li><a href="#whats-better-for-code-conciseness-or-readability"><span class="toc-section-number">7.34</span> What’s better for code, conciseness or readability?<span></span></a></li>
<li><a href="#how-find-i-find-resources-to-navigate-the-neon-data-portal"><span class="toc-section-number">7.35</span> How find I find resources to navigate the NEON Data Portal?<span></span></a></li>
<li><a href="#how-can-i-best-prepare-for-class-and-succeed"><span class="toc-section-number">7.36</span> How can I best prepare for class and succeed?<span></span></a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Informatics Using Research Infrastructures and their Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="preface" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Preface<a href="#preface" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="acknowledgements" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Acknowledgements<a href="#acknowledgements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="key-contributors" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Key Contributors<a href="#key-contributors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:index.Rmd-->
</div>
</div>
</div>
<div id="pre-course-setup-ecoinformatics-tools" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Pre-Course Setup: EcoInformatics Tools<a href="#pre-course-setup-ecoinformatics-tools" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="pre-course-skills-setup" class="section level2 hasAnchor" number="0.1">
<h2 class="hasAnchor"><span class="header-section-number">0.1</span> Pre-Course Skills &amp; Setup<a href="#pre-course-skills-setup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="installing-or-updating-r" class="section level3 hasAnchor" number="0.1.1">
<h3 class="hasAnchor"><span class="header-section-number">0.1.1</span> Installing or Updating R<a href="#installing-or-updating-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="windows-rrstudio-setup" class="section level3 hasAnchor" number="0.1.2">
<h3 class="hasAnchor"><span class="header-section-number">0.1.2</span> Windows R/RStudio Setup<a href="#windows-rrstudio-setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="mac-rrstudio-setup" class="section level3 hasAnchor" number="0.1.3">
<h3 class="hasAnchor"><span class="header-section-number">0.1.3</span> Mac R/RStudio Setup<a href="#mac-rrstudio-setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="linux-rrstudio-setup" class="section level2 hasAnchor" number="0.2">
<h2 class="hasAnchor"><span class="header-section-number">0.2</span> Linux R/RStudio Setup<a href="#linux-rrstudio-setup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="install-basic-packages-for-this-course" class="section level3 hasAnchor" number="0.2.1">
<h3 class="hasAnchor"><span class="header-section-number">0.2.1</span> Install basic packages for this course<a href="#install-basic-packages-for-this-course" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="installing-and-setting-up-git-github-on-your-machine" class="section level2 hasAnchor" number="0.3">
<h2 class="hasAnchor"><span class="header-section-number">0.3</span> Installing and Setting up Git &amp; Github on Your Machine<a href="#installing-and-setting-up-git-github-on-your-machine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="installing-atom" class="section level2 hasAnchor" number="0.4">
<h2 class="hasAnchor"><span class="header-section-number">0.4</span> Installing Atom<a href="#installing-atom" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="linking-rstudio-to-git" class="section level2 hasAnchor" number="0.5">
<h2 class="hasAnchor"><span class="header-section-number">0.5</span> Linking RStudio to Git<a href="#linking-rstudio-to-git" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="how-we-will-be-conducting-this-course" class="section level2 hasAnchor" number="0.6">
<h2 class="hasAnchor"><span class="header-section-number">0.6</span> How we will be Conducting this Course<a href="#how-we-will-be-conducting-this-course" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="exercises" class="section level2 hasAnchor" number="0.7">
<h2 class="hasAnchor"><span class="header-section-number">0.7</span> Exercises:<a href="#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-framework-of-this-course" class="section level2 hasAnchor" number="0.8">
<h2 class="hasAnchor"><span class="header-section-number">0.8</span> The Framework of this Course<a href="#the-framework-of-this-course" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="final-course-project-proposed-derived-data-product" class="section level2 hasAnchor" number="0.9">
<h2 class="hasAnchor"><span class="header-section-number">0.9</span> Final Course Project: Proposed Derived Data Product<a href="#final-course-project-proposed-derived-data-product" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:01_Pre-Course_Skills.Rmd-->
</div>
</div>
<div id="introduction-to-neon-its-data" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Introduction to NEON &amp; its Data<a href="#introduction-to-neon-its-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="learning-objectives" class="section level2 hasAnchor" number="1.1">
<h2 class="hasAnchor"><span class="header-section-number">1.1</span> Learning Objectives<a href="#learning-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-neon-project-mission-design" class="section level2 hasAnchor" number="1.2">
<h2 class="hasAnchor"><span class="header-section-number">1.2</span> The NEON Project Mission &amp; Design<a href="#the-neon-project-mission-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-science-and-design-of-neon" class="section level2 hasAnchor" number="1.3">
<h2 class="hasAnchor"><span class="header-section-number">1.3</span> The Science and Design of NEON<a href="#the-science-and-design-of-neon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="neons-spatial-design" class="section level2 hasAnchor" number="1.4">
<h2 class="hasAnchor"><span class="header-section-number">1.4</span> NEON’s Spatial Design<a href="#neons-spatial-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="neon-samples-all-20-eco-regions" class="section level3 hasAnchor" number="1.4.1">
<h3 class="hasAnchor"><span class="header-section-number">1.4.1</span> NEON Samples All 20 Eco-Regions<a href="#neon-samples-all-20-eco-regions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="how-neon-collects-data" class="section level2 hasAnchor" number="1.5">
<h2 class="hasAnchor"><span class="header-section-number">1.5</span> How NEON Collects Data<a href="#how-neon-collects-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="specimens-samples" class="section level3 hasAnchor" number="1.5.1">
<h3 class="hasAnchor"><span class="header-section-number">1.5.1</span> Specimens &amp; Samples<a href="#specimens-samples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="airborne-remote-sensing" class="section level3 hasAnchor" number="1.5.2">
<h3 class="hasAnchor"><span class="header-section-number">1.5.2</span> Airborne Remote Sensing<a href="#airborne-remote-sensing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="accessing-neon-data" class="section level2 hasAnchor" number="1.6">
<h2 class="hasAnchor"><span class="header-section-number">1.6</span> Accessing NEON Data<a href="#accessing-neon-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="pathways-to-access-neon-data" class="section level3 hasAnchor" number="1.6.1">
<h3 class="hasAnchor"><span class="header-section-number">1.6.1</span> Pathways to access NEON Data<a href="#pathways-to-access-neon-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="hands-on-accessing-neon-data-user-tokens" class="section level2 hasAnchor" number="1.7">
<h2 class="hasAnchor"><span class="header-section-number">1.7</span> Hands on: Accessing NEON Data &amp; User Tokens<a href="#hands-on-accessing-neon-data-user-tokens" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="via-the-neon-api-with-your-user-token" class="section level3 hasAnchor" number="1.7.1">
<h3 class="hasAnchor"><span class="header-section-number">1.7.1</span> Via the NEON API, with your User Token<a href="#via-the-neon-api-with-your-user-token" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="objectives" class="section level3 hasAnchor" number="1.7.2">
<h3 class="hasAnchor"><span class="header-section-number">1.7.2</span> Objectives<a href="#objectives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="things-youll-need-to-complete-this-tutorial" class="section level3 hasAnchor" number="1.7.3">
<h3 class="hasAnchor"><span class="header-section-number">1.7.3</span> Things You’ll Need To Complete This Tutorial<a href="#things-youll-need-to-complete-this-tutorial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="install-r-packages" class="section level3 hasAnchor" number="1.7.4">
<h3 class="hasAnchor"><span class="header-section-number">1.7.4</span> Install R Packages<a href="#install-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="additional-resources" class="section level2 hasAnchor" number="1.8">
<h2 class="hasAnchor"><span class="header-section-number">1.8</span> Additional Resources<a href="#additional-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="get-a-neon-api-token" class="section level3 hasAnchor" number="1.8.1">
<h3 class="hasAnchor"><span class="header-section-number">1.8.1</span> Get a NEON API Token<a href="#get-a-neon-api-token" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="use-the-api-token-in-neonutilities" class="section level3 hasAnchor" number="1.8.2">
<h3 class="hasAnchor"><span class="header-section-number">1.8.2</span> Use the API token in neonUtilities<a href="#use-the-api-token-in-neonutilities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="token-management-for-open-code" class="section level3 hasAnchor" number="1.8.3">
<h3 class="hasAnchor"><span class="header-section-number">1.8.3</span> Token management for open code<a href="#token-management-for-open-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="option-1-save-token-in-a-local-file" class="section level4 hasAnchor" number="1.8.3.1">
<h4 class="hasAnchor"><span class="header-section-number">1.8.3.1</span> Option 1: Save token in a local file<a href="#option-1-save-token-in-a-local-file" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="option-2-save-your-toekn-to-your-r-environment" class="section level4 hasAnchor" number="1.8.3.2">
<h4 class="hasAnchor"><span class="header-section-number">1.8.3.2</span> Option 2: Save your toekn to your R environment<a href="#option-2-save-your-toekn-to-your-r-environment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="hands-on-neon-tos-data" class="section level2 hasAnchor" number="1.9">
<h2 class="hasAnchor"><span class="header-section-number">1.9</span> Hands on: NEON TOS Data<a href="#hands-on-neon-tos-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="pull-in-tree-data-from-neons-tos-and-investigate-relationships" class="section level3 hasAnchor" number="1.9.1">
<h3 class="hasAnchor"><span class="header-section-number">1.9.1</span> Pull in Tree Data from NEON’s TOS and investigate relationships<a href="#pull-in-tree-data-from-neons-tos-and-investigate-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="intro-to-neon-exercises-part-1" class="section level2 hasAnchor" number="1.10">
<h2 class="hasAnchor"><span class="header-section-number">1.10</span> Intro to NEON Exercises Part 1<a href="#intro-to-neon-exercises-part-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-2.1-computational" class="section level3 hasAnchor" number="1.10.1">
<h3 class="hasAnchor"><span class="header-section-number">1.10.1</span> Exercise 2.1: Computational<a href="#exercise-2.1-computational" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sign-up-for-and-use-an-neon-api-token" class="section level4 hasAnchor" number="1.10.1.1">
<h4 class="hasAnchor"><span class="header-section-number">1.10.1.1</span> Sign up for and Use an NEON API Token:<a href="#sign-up-for-and-use-an-neon-api-token" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="further-investigation-of-neon-tos-vegetation-structure-data" class="section level4 hasAnchor" number="1.10.1.2">
<h4 class="hasAnchor"><span class="header-section-number">1.10.1.2</span> Further Investigation of NEON TOS Vegetation Structure Data<a href="#further-investigation-of-neon-tos-vegetation-structure-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="hands-on-pulling-neon-data-via-the-api" class="section level2 hasAnchor" number="1.11">
<h2 class="hasAnchor"><span class="header-section-number">1.11</span> Hands on: Pulling NEON Data via the API<a href="#hands-on-pulling-neon-data-via-the-api" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="objectives-1" class="section level3 hasAnchor" number="1.11.1">
<h3 class="hasAnchor"><span class="header-section-number">1.11.1</span> Objectives<a href="#objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="things-youll-need-to-complete-this-section" class="section level3 hasAnchor" number="1.11.2">
<h3 class="hasAnchor"><span class="header-section-number">1.11.2</span> Things You’ll Need To Complete This Section<a href="#things-youll-need-to-complete-this-section" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="install-r-packages-1" class="section level4 hasAnchor" number="1.11.2.1">
<h4 class="hasAnchor"><span class="header-section-number">1.11.2.1</span> Install R Packages<a href="#install-r-packages-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="additional-resources-1" class="section level4 hasAnchor" number="1.11.2.2">
<h4 class="hasAnchor"><span class="header-section-number">1.11.2.2</span> Additional Resources<a href="#additional-resources-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="what-is-an-api" class="section level2 hasAnchor" number="1.12">
<h2 class="hasAnchor"><span class="header-section-number">1.12</span> What is an API?<a href="#what-is-an-api" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="anatomy-of-an-api-call" class="section level3 hasAnchor" number="1.12.1">
<h3 class="hasAnchor"><span class="header-section-number">1.12.1</span> Anatomy of an API call<a href="#anatomy-of-an-api-call" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="base-url" class="section level4 hasAnchor" number="1.12.1.1">
<h4 class="hasAnchor"><span class="header-section-number">1.12.1.1</span> Base URL:<a href="#base-url" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="endpoints" class="section level4 hasAnchor" number="1.12.1.2">
<h4 class="hasAnchor"><span class="header-section-number">1.12.1.2</span> Endpoints:<a href="#endpoints" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="targets" class="section level3 hasAnchor" number="1.12.2">
<h3 class="hasAnchor"><span class="header-section-number">1.12.2</span> Targets:<a href="#targets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="observational-data-os" class="section level3 hasAnchor" number="1.12.3">
<h3 class="hasAnchor"><span class="header-section-number">1.12.3</span> Observational data (OS)<a href="#observational-data-os" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="instrumentation-data-is" class="section level3 hasAnchor" number="1.12.4">
<h3 class="hasAnchor"><span class="header-section-number">1.12.4</span> Instrumentation data (IS)<a href="#instrumentation-data-is" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="remote-sensing-data-aop" class="section level3 hasAnchor" number="1.12.5">
<h3 class="hasAnchor"><span class="header-section-number">1.12.5</span> Remote sensing data (AOP)<a href="#remote-sensing-data-aop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="geolocation-data" class="section level3 hasAnchor" number="1.12.6">
<h3 class="hasAnchor"><span class="header-section-number">1.12.6</span> Geolocation data<a href="#geolocation-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="instrumentation-data-both-aquatic-and-terrestrial" class="section level4 hasAnchor" number="1.12.6.1">
<h4 class="hasAnchor"><span class="header-section-number">1.12.6.1</span> Instrumentation data (both aquatic and terrestrial)<a href="#instrumentation-data-both-aquatic-and-terrestrial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="observational-data---terrestrial" class="section level4 hasAnchor" number="1.12.6.2">
<h4 class="hasAnchor"><span class="header-section-number">1.12.6.2</span> Observational data - Terrestrial<a href="#observational-data---terrestrial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="querying-a-single-named-location" class="section level3 hasAnchor" number="1.12.7">
<h3 class="hasAnchor"><span class="header-section-number">1.12.7</span> Querying a single named location<a href="#querying-a-single-named-location" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="taxonomy" class="section level3 hasAnchor" number="1.12.8">
<h3 class="hasAnchor"><span class="header-section-number">1.12.8</span> Taxonomy<a href="#taxonomy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="stacking-neon-data" class="section level2 hasAnchor" number="1.13">
<h2 class="hasAnchor"><span class="header-section-number">1.13</span> Stacking NEON data<a href="#stacking-neon-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="intro-to-neon-exercises-part-2" class="section level2 hasAnchor" number="1.14">
<h2 class="hasAnchor"><span class="header-section-number">1.14</span> Intro to NEON Exercises Part 2<a href="#intro-to-neon-exercises-part-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-2.2-written-questions" class="section level3 hasAnchor" number="1.14.1">
<h3 class="hasAnchor"><span class="header-section-number">1.14.1</span> Exercise 2.2: Written questions<a href="#exercise-2.2-written-questions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="exercise-2.3-neon-coding-lab" class="section level3 hasAnchor" number="1.14.2">
<h3 class="hasAnchor"><span class="header-section-number">1.14.2</span> Exercise 2.3: NEON Coding Lab<a href="#exercise-2.3-neon-coding-lab" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="exercise-2.4-intro-to-neon-culmination-activity" class="section level3 hasAnchor" number="1.14.3">
<h3 class="hasAnchor"><span class="header-section-number">1.14.3</span> Exercise 2.4: Intro to NEON Culmination Activity<a href="#exercise-2.4-intro-to-neon-culmination-activity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:02_Introduction_to_NEON.Rmd-->
</div>
</div>
</div>
<div id="introduction-to-usa-npn-its-data" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Introduction to USA-NPN &amp; its Data<a href="#introduction-to-usa-npn-its-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="usa-npn-learning-objectives" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> USA-NPN Learning Objectives<a href="#usa-npn-learning-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="usa-npn-project-mission-design" class="section level2 hasAnchor" number="2.2">
<h2 class="hasAnchor"><span class="header-section-number">2.2</span> USA-NPN Project Mission &amp; Design:<a href="#usa-npn-project-mission-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="vision-mission" class="section level2 hasAnchor" number="2.3">
<h2 class="hasAnchor"><span class="header-section-number">2.3</span> Vision &amp; Mission<a href="#vision-mission" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="relevant-documents-background-information" class="section level3 hasAnchor" number="2.3.1">
<h3 class="hasAnchor"><span class="header-section-number">2.3.1</span> Relevant documents &amp; background information:<a href="#relevant-documents-background-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="usa-npns-spatial-design" class="section level2 hasAnchor" number="2.4">
<h2 class="hasAnchor"><span class="header-section-number">2.4</span> USA-NPN’s Spatial design:<a href="#usa-npns-spatial-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="types-of-usa-npn-data" class="section level2 hasAnchor" number="2.5">
<h2 class="hasAnchor"><span class="header-section-number">2.5</span> Types of USA-NPN Data:<a href="#types-of-usa-npn-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="observational" class="section level3 hasAnchor" number="2.5.1">
<h3 class="hasAnchor"><span class="header-section-number">2.5.1</span> Observational<a href="#observational" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="status-intensity-data" class="section level3 hasAnchor" number="2.5.2">
<h3 class="hasAnchor"><span class="header-section-number">2.5.2</span> Status &amp; Intensity Data<a href="#status-intensity-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="gridded-raster-data" class="section level3 hasAnchor" number="2.5.3">
<h3 class="hasAnchor"><span class="header-section-number">2.5.3</span> Gridded Raster Data<a href="#gridded-raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="pheno-forecasts" class="section level3 hasAnchor" number="2.5.4">
<h3 class="hasAnchor"><span class="header-section-number">2.5.4</span> Pheno-Forecasts<a href="#pheno-forecasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="how-to-access-usa-npn-data" class="section level2 hasAnchor" number="2.6">
<h2 class="hasAnchor"><span class="header-section-number">2.6</span> How to Access USA-NPN Data:<a href="#how-to-access-usa-npn-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-usa-npn-landing-page" class="section level3 hasAnchor" number="2.6.1">
<h3 class="hasAnchor"><span class="header-section-number">2.6.1</span> The USA-NPN Landing page<a href="#the-usa-npn-landing-page" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="apis" class="section level3 hasAnchor" number="2.6.2">
<h3 class="hasAnchor"><span class="header-section-number">2.6.2</span> APIs<a href="#apis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="rnpn-package" class="section level3 hasAnchor" number="2.6.3">
<h3 class="hasAnchor"><span class="header-section-number">2.6.3</span> Rnpn package<a href="#rnpn-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="phenology-observation-portal-for-observational-data" class="section level3 hasAnchor" number="2.6.4">
<h3 class="hasAnchor"><span class="header-section-number">2.6.4</span> Phenology Observation Portal (for observational data)<a href="#phenology-observation-portal-for-observational-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="geospatial-request-builder-for-raster-data-and-image-files" class="section level3 hasAnchor" number="2.6.5">
<h3 class="hasAnchor"><span class="header-section-number">2.6.5</span> Geospatial Request Builder (for raster data and image files)<a href="#geospatial-request-builder-for-raster-data-and-image-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="visualization-tool" class="section level3 hasAnchor" number="2.6.6">
<h3 class="hasAnchor"><span class="header-section-number">2.6.6</span> Visualization Tool<a href="#visualization-tool" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="usa-npn-written-questions" class="section level2 hasAnchor" number="2.7">
<h2 class="hasAnchor"><span class="header-section-number">2.7</span> USA-NPN Written Questions<a href="#usa-npn-written-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="hands-on-accessing-usa-npn-data-via-rnpn" class="section level2 hasAnchor" number="2.8">
<h2 class="hasAnchor"><span class="header-section-number">2.8</span> Hands on: Accessing USA-NPN Data via rNPN<a href="#hands-on-accessing-usa-npn-data-via-rnpn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction" class="section level3 hasAnchor" number="2.8.1">
<h3 class="hasAnchor"><span class="header-section-number">2.8.1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="accessing-usa-npn-observational-data" class="section level3 hasAnchor" number="2.8.2">
<h3 class="hasAnchor"><span class="header-section-number">2.8.2</span> Accessing USA-NPN Observational Data<a href="#accessing-usa-npn-observational-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="basic-format-for-for-observational-data-calls" class="section level4 hasAnchor" number="2.8.2.1">
<h4 class="hasAnchor"><span class="header-section-number">2.8.2.1</span> Basic format for for Observational data calls<a href="#basic-format-for-for-observational-data-calls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="required-parameters" class="section level4 hasAnchor" number="2.8.2.2">
<h4 class="hasAnchor"><span class="header-section-number">2.8.2.2</span> Required Parameters<a href="#required-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="find-stations-at-which-a-species-has-been-observed" class="section level4 hasAnchor" number="2.8.2.3">
<h4 class="hasAnchor"><span class="header-section-number">2.8.2.3</span> Find stations at which a species has been observed<a href="#find-stations-at-which-a-species-has-been-observed" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="status-and-intensity-data" class="section level3 hasAnchor" number="2.8.3">
<h3 class="hasAnchor"><span class="header-section-number">2.8.3</span> Status and Intensity Data<a href="#status-and-intensity-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="individual-phenometrics" class="section level3 hasAnchor" number="2.8.4">
<h3 class="hasAnchor"><span class="header-section-number">2.8.4</span> Individual Phenometrics<a href="#individual-phenometrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="site-phenometrics" class="section level3 hasAnchor" number="2.8.5">
<h3 class="hasAnchor"><span class="header-section-number">2.8.5</span> Site Phenometrics<a href="#site-phenometrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="magnitude-phenometrics" class="section level3 hasAnchor" number="2.8.6">
<h3 class="hasAnchor"><span class="header-section-number">2.8.6</span> Magnitude Phenometrics<a href="#magnitude-phenometrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="usa-npn-geospatial-data" class="section level3 hasAnchor" number="2.8.7">
<h3 class="hasAnchor"><span class="header-section-number">2.8.7</span> USA-NPN Geospatial Data<a href="#usa-npn-geospatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="accumulated-growing-degree-day-products" class="section level2 hasAnchor" number="2.9">
<h2 class="hasAnchor"><span class="header-section-number">2.9</span> Accumulated Growing Degree Day Products<a href="#accumulated-growing-degree-day-products" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="extended-spring-indices" class="section level2 hasAnchor" number="2.10">
<h2 class="hasAnchor"><span class="header-section-number">2.10</span> Extended Spring Indices<a href="#extended-spring-indices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="other-layers" class="section level3 hasAnchor" number="2.10.1">
<h3 class="hasAnchor"><span class="header-section-number">2.10.1</span> Other Layers<a href="#other-layers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="putting-it-all-together" class="section level2 hasAnchor" number="2.11">
<h2 class="hasAnchor"><span class="header-section-number">2.11</span> Putting it all together:<a href="#putting-it-all-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="combine-point-and-raster-data" class="section level2 hasAnchor" number="2.12">
<h2 class="hasAnchor"><span class="header-section-number">2.12</span> Combine Point and Raster Data<a href="#combine-point-and-raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="step-1-get-the-data" class="section level3 hasAnchor" number="2.12.1">
<h3 class="hasAnchor"><span class="header-section-number">2.12.1</span> Step 1: Get the data<a href="#step-1-get-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="step-2-preparing-the-data" class="section level3 hasAnchor" number="2.12.2">
<h3 class="hasAnchor"><span class="header-section-number">2.12.2</span> Step 2: Preparing the data<a href="#step-2-preparing-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="step-3-define-style-options-and-create-graph" class="section level3 hasAnchor" number="2.12.3">
<h3 class="hasAnchor"><span class="header-section-number">2.12.3</span> Step 3: Define style options and create graph<a href="#step-3-define-style-options-and-create-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="live-demo-code-with-lee-marsh-of-usa-npn" class="section level2 hasAnchor" number="2.13">
<h2 class="hasAnchor"><span class="header-section-number">2.13</span> Live Demo Code with Lee Marsh of USA-NPN<a href="#live-demo-code-with-lee-marsh-of-usa-npn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="basic-utility-functions" class="section level3 hasAnchor" number="2.13.1">
<h3 class="hasAnchor"><span class="header-section-number">2.13.1</span> Basic Utility Functions<a href="#basic-utility-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="download-observational-data" class="section level3 hasAnchor" number="2.13.2">
<h3 class="hasAnchor"><span class="header-section-number">2.13.2</span> Download Observational Data<a href="#download-observational-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="magnitude-data" class="section level3 hasAnchor" number="2.13.3">
<h3 class="hasAnchor"><span class="header-section-number">2.13.3</span> Magnitude Data<a href="#magnitude-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="downloading-geospatial-data" class="section level3 hasAnchor" number="2.13.4">
<h3 class="hasAnchor"><span class="header-section-number">2.13.4</span> Downloading Geospatial Data<a href="#downloading-geospatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="putting-it-together" class="section level3 hasAnchor" number="2.13.5">
<h3 class="hasAnchor"><span class="header-section-number">2.13.5</span> Putting it together<a href="#putting-it-together" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="other-data-sources-e.g.-daymet-modis" class="section level3 hasAnchor" number="2.13.6">
<h3 class="hasAnchor"><span class="header-section-number">2.13.6</span> Other Data Sources, e.g. Daymet, MODIS<a href="#other-data-sources-e.g.-daymet-modis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="usa-npn-coding-lab" class="section level2 hasAnchor" number="2.14">
<h2 class="hasAnchor"><span class="header-section-number">2.14</span> USA-NPN Coding Lab<a href="#usa-npn-coding-lab" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="neon-tos-phenology-data-lecture" class="section level2 hasAnchor" number="2.15">
<h2 class="hasAnchor"><span class="header-section-number">2.15</span> NEON TOS Phenology Data Lecture<a href="#neon-tos-phenology-data-lecture" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="understanding-observation-biases-and-censoring-in-citizen-science-data" class="section level2 hasAnchor" number="2.16">
<h2 class="hasAnchor"><span class="header-section-number">2.16</span> Understanding Observation Biases and Censoring in Citizen Science Data<a href="#understanding-observation-biases-and-censoring-in-citizen-science-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="many-existing-modeling-approaches-fail-in-one-or-both-regards." class="section level3 hasAnchor" number="2.16.1">
<h3 class="hasAnchor"><span class="header-section-number">2.16.1</span> Many existing modeling approaches fail in one (or both) regards.<a href="#many-existing-modeling-approaches-fail-in-one-or-both-regards." class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="censoring" class="section level3 hasAnchor" number="2.16.2">
<h3 class="hasAnchor"><span class="header-section-number">2.16.2</span> Censoring<a href="#censoring" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="so-then-how-can-we-model-censored-data" class="section level2 hasAnchor" number="2.17">
<h2 class="hasAnchor"><span class="header-section-number">2.17</span> So then how can we model censored data?<a href="#so-then-how-can-we-model-censored-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="intro-to-usa-npn-culmination-activity" class="section level2 hasAnchor" number="2.18">
<h2 class="hasAnchor"><span class="header-section-number">2.18</span> Intro to USA-NPN Culmination Activity<a href="#intro-to-usa-npn-culmination-activity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:03-USA-NPN.Rmd-->
</div>
</div>
<div id="phenocam-digital-repeat-photography-networks-methods" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> PhenoCam: Digital Repeat Photography Networks &amp; Methods<a href="#phenocam-digital-repeat-photography-networks-methods" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="digital-repeat-photography-networks-learning-objectives" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Digital Repeat Photography Networks Learning Objectives<a href="#digital-repeat-photography-networks-learning-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-phenocam-network-mission-design" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> The PhenoCam Network Mission &amp; Design<a href="#the-phenocam-network-mission-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="relevant-documents-background-information-1" class="section level3 hasAnchor" number="3.2.1">
<h3 class="hasAnchor"><span class="header-section-number">3.2.1</span> Relevant documents &amp; background information:<a href="#relevant-documents-background-information-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="phenocams-spatial-design" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> PhenoCam’s Spatial design:<a href="#phenocams-spatial-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="phenocam-as-a-near-surface-remote-sensing-technique" class="section level3 hasAnchor" number="3.3.1">
<h3 class="hasAnchor"><span class="header-section-number">3.3.1</span> PhenoCam as a Near Surface Remote Sensing Technique<a href="#phenocam-as-a-near-surface-remote-sensing-technique" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="how-phenocams-pull-data" class="section level3 hasAnchor" number="3.3.2">
<h3 class="hasAnchor"><span class="header-section-number">3.3.2</span> How PhenoCams Pull Data<a href="#how-phenocams-pull-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="leveraging-camera-near-infrared-nir-capabilities" class="section level3 hasAnchor" number="3.3.3">
<h3 class="hasAnchor"><span class="header-section-number">3.3.3</span> Leveraging camera near-infrared (NIR) capabilities<a href="#leveraging-camera-near-infrared-nir-capabilities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="digital-repeat-photography-written-questions" class="section level2 hasAnchor" number="3.4">
<h2 class="hasAnchor"><span class="header-section-number">3.4</span> Digital Repeat Photography Written Questions<a href="#digital-repeat-photography-written-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="introduction-to-digital-repeat-photography-methods" class="section level2 hasAnchor" number="3.5">
<h2 class="hasAnchor"><span class="header-section-number">3.5</span> Introduction to Digital Repeat Photography Methods<a href="#introduction-to-digital-repeat-photography-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="pulling-data-via-the-phenocamapi-package" class="section level2 hasAnchor" number="3.6">
<h2 class="hasAnchor"><span class="header-section-number">3.6</span> Pulling Data via the <em>phenocamapi</em> Package<a href="#pulling-data-via-the-phenocamapi-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="exploring-phenocam-metadata" class="section level2 hasAnchor" number="3.7">
<h2 class="hasAnchor"><span class="header-section-number">3.7</span> Exploring PhenoCam metadata<a href="#exploring-phenocam-metadata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="remove-null-values" class="section level3 hasAnchor" number="3.7.1">
<h3 class="hasAnchor"><span class="header-section-number">3.7.1</span> Remove null values<a href="#remove-null-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="filtering-using-attributes" class="section level3 hasAnchor" number="3.7.2">
<h3 class="hasAnchor"><span class="header-section-number">3.7.2</span> Filtering using attributes<a href="#filtering-using-attributes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="download-midday-images" class="section level2 hasAnchor" number="3.8">
<h2 class="hasAnchor"><span class="header-section-number">3.8</span> Download midday images<a href="#download-midday-images" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="download-midday-images-for-a-given-time-range" class="section level3 hasAnchor" number="3.8.1">
<h3 class="hasAnchor"><span class="header-section-number">3.8.1</span> Download midday images for a given time range<a href="#download-midday-images-for-a-given-time-range" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="detecting-foggy-images-using-the-hazer-r-package" class="section level2 hasAnchor" number="3.9">
<h2 class="hasAnchor"><span class="header-section-number">3.9</span> Detecting Foggy Images using the ‘hazer’ R Package<a href="#detecting-foggy-images-using-the-hazer-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="read-plot-an-image" class="section level4 hasAnchor" number="3.9.0.1">
<h4 class="hasAnchor"><span class="header-section-number">3.9.0.1</span> Read &amp; Plot an Image<a href="#read-plot-an-image" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="histogram-of-rgb-channels" class="section level4 hasAnchor" number="3.9.0.2">
<h4 class="hasAnchor"><span class="header-section-number">3.9.0.2</span> Histogram of RGB channels<a href="#histogram-of-rgb-channels" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="brightness" class="section level4 hasAnchor" number="3.9.0.3">
<h4 class="hasAnchor"><span class="header-section-number">3.9.0.3</span> Brightness<a href="#brightness" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="darkness" class="section level4 hasAnchor" number="3.9.0.4">
<h4 class="hasAnchor"><span class="header-section-number">3.9.0.4</span> Darkness<a href="#darkness" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="contrast" class="section level4 hasAnchor" number="3.9.0.5">
<h4 class="hasAnchor"><span class="header-section-number">3.9.0.5</span> Contrast<a href="#contrast" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="image-fogginess-haziness" class="section level4 hasAnchor" number="3.9.0.6">
<h4 class="hasAnchor"><span class="header-section-number">3.9.0.6</span> Image fogginess &amp; haziness<a href="#image-fogginess-haziness" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="process-sets-of-images" class="section level4 hasAnchor" number="3.9.0.7">
<h4 class="hasAnchor"><span class="header-section-number">3.9.0.7</span> Process sets of images<a href="#process-sets-of-images" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="extracting-timeseries-from-images-using-the-xroi-r-package" class="section level2 hasAnchor" number="3.10">
<h2 class="hasAnchor"><span class="header-section-number">3.10</span> Extracting Timeseries from Images using the xROI R Package<a href="#extracting-timeseries-from-images-using-the-xroi-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="xroi-design" class="section level3 hasAnchor" number="3.10.1">
<h3 class="hasAnchor"><span class="header-section-number">3.10.1</span> xROI Design<a href="#xroi-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="install-xroi" class="section level3 hasAnchor" number="3.10.2">
<h3 class="hasAnchor"><span class="header-section-number">3.10.2</span> Install xROI<a href="#install-xroi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="launch-xroi" class="section level3 hasAnchor" number="3.10.3">
<h3 class="hasAnchor"><span class="header-section-number">3.10.3</span> Launch xROI<a href="#launch-xroi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="end-xroi" class="section level3 hasAnchor" number="3.10.4">
<h3 class="hasAnchor"><span class="header-section-number">3.10.4</span> End xROI<a href="#end-xroi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="use-xroi" class="section level3 hasAnchor" number="3.10.5">
<h3 class="hasAnchor"><span class="header-section-number">3.10.5</span> Use xROI<a href="#use-xroi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="documentation-and-citation" class="section level2 hasAnchor" number="3.11">
<h2 class="hasAnchor"><span class="header-section-number">3.11</span> Documentation and Citation<a href="#documentation-and-citation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="challenge-use-xroi" class="section level3 hasAnchor" number="3.11.1">
<h3 class="hasAnchor"><span class="header-section-number">3.11.1</span> Challenge: Use xROI<a href="#challenge-use-xroi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="hands-on-digital-repeat-photography-computational" class="section level2 hasAnchor" number="3.12">
<h2 class="hasAnchor"><span class="header-section-number">3.12</span> Hands on: Digital Repeat Photography Computational<a href="#hands-on-digital-repeat-photography-computational" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="phenocam-time-series" class="section level3 hasAnchor" number="3.12.1">
<h3 class="hasAnchor"><span class="header-section-number">3.12.1</span> PhenoCam time series<a href="#phenocam-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="obtain-rois" class="section level3 hasAnchor" number="3.12.2">
<h3 class="hasAnchor"><span class="header-section-number">3.12.2</span> Obtain ROIs<a href="#obtain-rois" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="download-time-series" class="section level3 hasAnchor" number="3.12.3">
<h3 class="hasAnchor"><span class="header-section-number">3.12.3</span> Download time series<a href="#download-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="threshold-values" class="section level3 hasAnchor" number="3.12.4">
<h3 class="hasAnchor"><span class="header-section-number">3.12.4</span> Threshold values<a href="#threshold-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="comparing-phenology-across-vegetation-types" class="section level3 hasAnchor" number="3.12.5">
<h3 class="hasAnchor"><span class="header-section-number">3.12.5</span> Comparing phenology across vegetation types<a href="#comparing-phenology-across-vegetation-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="in-class-hands-on-coding-comparing-phenology-of-the-same-plant-function-type-pft-across-climate-space" class="section level3 hasAnchor" number="3.12.6">
<h3 class="hasAnchor"><span class="header-section-number">3.12.6</span> In Class Hands-on Coding: Comparing phenology of the same plant function type (PFT) across climate space<a href="#in-class-hands-on-coding-comparing-phenology-of-the-same-plant-function-type-pft-across-climate-space" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="digital-repeat-photography-coding-lab" class="section level2 hasAnchor" number="3.13">
<h2 class="hasAnchor"><span class="header-section-number">3.13</span> Digital Repeat Photography Coding Lab<a href="#digital-repeat-photography-coding-lab" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="quantifying-haze-and-redness-to-evaluate-california-wildfires" class="section level3 hasAnchor" number="3.13.1">
<h3 class="hasAnchor"><span class="header-section-number">3.13.1</span> Quantifying haze and redness to evaluate California wildfires<a href="#quantifying-haze-and-redness-to-evaluate-california-wildfires" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="phenocam-culmination-activity" class="section level2 hasAnchor" number="3.14">
<h2 class="hasAnchor"><span class="header-section-number">3.14</span> PhenoCam Culmination Activity<a href="#phenocam-culmination-activity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:05-PhenoCam.Rmd-->
</div>
</div>
<div id="flux-measurements-inter-operability" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Flux Measurements &amp; Inter-Operability<a href="#flux-measurements-inter-operability" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>Estimated Time: 3 hours</p>
</blockquote>
<div id="ds-challenge" markdown="1">


<div id="ds-challenge" markdown="1">
<p><strong>Course participants</strong>: As you review this information, please
consider the final course project
that you will work on at the over this semester. At the end of this section, you will
document an initial research question or idea and associated data needed to
address that question, that you may want to explore while pursuing this course.</p>
<div id="learning-objectives-1" class="section level2 hasAnchor" number="4.1">
<h2 class="hasAnchor"><span class="header-section-number">4.1</span> Learning Objectives<a href="#learning-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the end of this activity, you will be able to:</p>
<ul>
<li><p>Define the eddy covariance method</p></li>
<li><p>Articulate various carbon storage and flux terms</p></li>
<li><p>Understand the structure of bundled eddy covariance data</p></li>
<li><p>Be able to process NEON flux data such that it is comparable with AmeriFlux</p></li>
</ul>
</div>
<div id="eddy-co_variance-data-what-does-it-actually-measure" class="section level2 hasAnchor" number="4.2">
<h2 class="hasAnchor"><span class="header-section-number">4.2</span> Eddy Co_variance Data: What does it actually measure?<a href="#eddy-co_variance-data-what-does-it-actually-measure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/CR4Anc8Mkas" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="example-eddy-site" class="section level3 hasAnchor" number="4.2.1">
<h3 class="hasAnchor"><span class="header-section-number">4.2.1</span> Example Eddy Site<a href="#example-eddy-site" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/XrxZy7Dp4ko" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
</div>
<div id="qaqc-flags" class="section level2 hasAnchor" number="4.3">
<h2 class="hasAnchor"><span class="header-section-number">4.3</span> QA/QC Flags<a href="#qaqc-flags" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="examples-of-other-flux-networks-ameriflux-fluxnet" class="section level2 hasAnchor" number="4.4">
<h2 class="hasAnchor"><span class="header-section-number">4.4</span> Examples of Other Flux Networks: AMERIFLUX &amp; FLUXNET<a href="#examples-of-other-flux-networks-ameriflux-fluxnet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>AmeriFlux is a <a href="">network of PI-managed sites</a> measuring ecosystem CO2, water, and energy fluxes in <a href="https://ameriflux.lbl.gov/sites/site-search/#filter-type=all&amp;has-data=All&amp;site_id=">North, Central and South America</a>. It was established to connect research on field sites representing major climate and ecological biomes, including tundra, grasslands, savanna, crops, and conifer, deciduous, and tropical forests. As a grassroots, investigator-driven network, the AmeriFlux community has tailored instrumentation to suit each unique ecosystem. This “coalition of the willing” is diverse in its interests, use of technologies and collaborative approaches. As a result, the AmeriFlux Network continually pioneers new ground.</p>
<p>The network was launched in 1996, after an international workshop on flux measurements in La Thuile, Italy, in 1995, where some of the first year-long flux measurements were presented. Early support for the network came from many sources, including the U.S. Department of Energy’s Terrestrial Carbon Program, the DOE’s National Institute of Global Environmental Change (NIGEC), NASA, NOAA and the US Forest Service. The network grew from about 15 sites in 1997 to more than 110 active sites registered today. Sixty-one other sites, now inactive, have flux data stored in the network’s database. In 2012, the U.S. DOE established the AmeriFlux Management Project (AMP) at Lawrence Berkeley National Laboratory (LBNL) to support the broad AmeriFlux community and the AmeriFlux sites.</p>
<p><a href="https://ameriflux.lbl.gov/about/network-at-a-glance/">View the AMERIFLUX Network-at-a-Glance</a></p>
<p>AmeriFlux is now one of the DOE Office of Biological and Environmental Research’s (BER) best-known and most highly regarded brands in climate and ecological research. AmeriFlux datasets, and the understanding derived from them, provide crucial linkages between terrestrial ecosystem processes and climate-relevant responses at landscape, regional, and continental scales.</p>
</div>
<div id="the-power-of-networked-ecology-bridging-to-ameriflux-and-beyond" class="section level2 hasAnchor" number="4.5">
<h2 class="hasAnchor"><span class="header-section-number">4.5</span> The Power of Networked Ecology: Bridging to AMERIFLUX and Beyond<a href="#the-power-of-networked-ecology-bridging-to-ameriflux-and-beyond" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given that <a href="https://ameriflux.lbl.gov/">AmeriFlux</a> has been collecting and coordinating eddy covariance data across the Americas since 1996. The network provides a common platform for data sharing and collaboration for organizations and individual private investigators collecting flux tower data. There are now &gt;470 registered flux tower sites in North, Central, and South America in the AmeriFlux network, many operated by individual researchers or universities. The towers collect eddy covariance data across a broad range of climate zones and ecosystem types, from Chile to Alaska and everywhere in between.</p>
<p>Now, data from the NEON project is available through the AmeriFlux data portal. The NEON team has formatted data from the NEON flux towers to make it fully compatible with AmeriFlux data. This allows researchers to view, download and analyze data from the NEON flux towers alongside data from all of the other flux towers in the AmeriFlux network.</p>
<p>With 47 flux towers at terrestrial field sites across the U.S., the NEON program is now the largest single contributor of flux tower data to the AmeriFlux network. NEON field sites are located in 20 ecoclimatic zones across the U.S., representing many distinct ecosystems. Eddy covariance data will be served using the same methods at each site for the entire 30-year life of the Observatory, allowing for unprecedented comparability across both time and space.</p>
</div>
<div id="hands-on-introduction-to-working-with-neon-eddy-flux-data" class="section level2 hasAnchor" number="4.6">
<h2 class="hasAnchor"><span class="header-section-number">4.6</span> Hands On: Introduction to working with NEON eddy flux data<a href="#hands-on-introduction-to-working-with-neon-eddy-flux-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="setup" class="section level3 hasAnchor" number="4.6.1">
<h3 class="hasAnchor"><span class="header-section-number">4.6.1</span> Setup<a href="#setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Start by installing and loading packages and setting options.
To work with the NEON flux data, we need the <code>rhdf5</code> package,
which is hosted on Bioconductor, and requires a different
installation process than CRAN packages:</p>
<pre><code>install.packages(&#39;BiocManager&#39;)
BiocManager::install(&#39;rhdf5&#39;)</code></pre>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neonUtilities)</span></code></pre></div>
<p>Use the <code>zipsByProduct()</code> function from the <code>neonUtilities</code> package to
download flux data from two sites and two months. The transformations
and functions below will work on any time range and site(s), but two
sites and two months allows us to see all the available functionality
while minimizing download size.</p>
<p>Inputs to the <code>zipsByProduct()</code> function:</p>
<ul>
<li><code>dpID</code>: DP4.00200.001, the bundled eddy covariance product</li>
<li><code>package</code>: basic (the expanded package is not covered in this tutorial)</li>
<li><code>site</code>: NIWO = Niwot Ridge and HARV = Harvard Forest</li>
<li><code>startdate</code>: 2018-06 (both dates are inclusive)</li>
<li><code>enddate</code>: 2018-07 (both dates are inclusive)</li>
<li><code>savepath</code>: modify this to something logical on your machine</li>
<li><code>check.size</code>: T if you want to see file size before downloading, otherwise F</li>
</ul>
<p>The download may take a while, especially if you’re on a slow network.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zipsByProduct</span>(<span class="at">dpID=</span><span class="st">&quot;DP4.00200.001&quot;</span>, <span class="at">package=</span><span class="st">&quot;basic&quot;</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">site=</span><span class="fu">c</span>(<span class="st">&quot;NIWO&quot;</span>, <span class="st">&quot;HARV&quot;</span>), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">startdate=</span><span class="st">&quot;2018-06&quot;</span>, <span class="at">enddate=</span><span class="st">&quot;2018-07&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">savepath=</span><span class="st">&quot;./data&quot;</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">check.size=</span>F)</span></code></pre></div>
<pre><code>## Finding available files
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================================| 100%
## 
## Downloading files totaling approximately 345.260177 MB</code></pre>
<pre><code>## ./data/filesToStack00200 already exists. Download will proceed, but check for duplicate files.</code></pre>
<pre><code>## Downloading 4 files
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=======================                                               |  33%
## NEON.D01.HARV.DP4.00200.001.2018-06.basic.20220120T173946Z.RELEASE-2022.zip could not be downloaded. Re-attempting.
## 
  |                                                                            
  |===============================================                       |  67%
## NEON.D01.HARV.DP4.00200.001.2018-07.basic.20220120T173946Z.RELEASE-2022.zip could not be downloaded. Re-attempting.
## 
  |                                                                            
  |======================================================================| 100%
## NEON.D13.NIWO.DP4.00200.001.2018-07.basic.20220120T173946Z.RELEASE-2022.zip could not be downloaded. Re-attempting.
## 
## 4 files successfully downloaded to ./data/filesToStack00200</code></pre>
</div>
<div id="data-levels" class="section level3 hasAnchor" number="4.6.2">
<h3 class="hasAnchor"><span class="header-section-number">4.6.2</span> Data Levels<a href="#data-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are five levels of data contained in the eddy flux bundle. For full
details, refer to the <a href="http://data.neonscience.org/api/v0/documents/NEON.DOC.004571vA" target="_blank">NEON algorithm document</a>.</p>
<p>Briefly, the data levels are:</p>
<ul>
<li>Level 0’ (dp0p): Calibrated raw observations</li>
<li>Level 1 (dp01): Time-aggregated observations, e.g. 30-minute mean gas concentrations</li>
<li>Level 2 (dp02): Time-interpolated data, e.g. rate of change of a gas concentration</li>
<li>Level 3 (dp03): Spatially interpolated data, i.e. vertical profiles</li>
<li>Level 4 (dp04): Fluxes</li>
</ul>
<p>The dp0p data are available in the expanded data package and are beyond
the scope of this tutorial.</p>
<p>The dp02 and dp03 data are used in storage calculations, and the dp04 data
include both the storage and turbulent components. Since many users will
want to focus on the net flux data, we’ll start there.</p>
</div>
<div id="extract-level-4-data-fluxes" class="section level3 hasAnchor" number="4.6.3">
<h3 class="hasAnchor"><span class="header-section-number">4.6.3</span> Extract Level 4 data (Fluxes!)<a href="#extract-level-4-data-fluxes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To extract the Level 4 data from the HDF5 files and merge them into a
single table, we’ll use the <code>stackEddy()</code> function from the <code>neonUtilities</code>
package.</p>
<p><code>stackEddy()</code> requires two inputs:</p>
<ul>
<li><code>filepath</code>: Path to a file or folder, which can be any one of:
<ol style="list-style-type: decimal">
<li>A zip file of eddy flux data downloaded from the NEON data portal</li>
<li>A folder of eddy flux data downloaded by the <code>zipsByProduct()</code> function</li>
<li>The folder of files resulting from unzipping either of 1 or 2</li>
<li>A single HDF5 file of NEON eddy flux data</li>
</ol></li>
<li><code>level</code>: dp01-4</li>
</ul>
<p>Input the filepath you downloaded to using <code>zipsByProduct()</code> earlier,
including the <code>filestoStack00200</code> folder created by the function, and
<code>dp04</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>flux <span class="ot">&lt;-</span> <span class="fu">stackEddy</span>(<span class="at">filepath=</span><span class="st">&quot;./data/filesToStack00200&quot;</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">level=</span><span class="st">&quot;dp04&quot;</span>)</span></code></pre></div>
<p>We now have an object called <code>flux</code>. It’s a named list containing four
tables: one table for each site’s data, and <code>variables</code> and <code>objDesc</code>
tables.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(flux)</span></code></pre></div>
<p>Let’s look at the contents of one of the site data files:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(flux<span class="sc">$</span>NIWO))</span></code></pre></div>
<p>The <code>variables</code> and <code>objDesc</code> tables can help you interpret the column
headers in the data table. The <code>objDesc</code> table contains definitions for
many of the terms used in the eddy flux data product, but it isn’t
complete. To get the terms of interest, we’ll break up the column headers
into individual terms and look for them in the <code>objDesc</code> table:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>term <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="fu">names</span>(flux<span class="sc">$</span>NIWO), <span class="at">split=</span><span class="st">&quot;.&quot;</span>, <span class="at">fixed=</span>T))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>flux<span class="sc">$</span>objDesc[<span class="fu">which</span>(flux<span class="sc">$</span>objDesc<span class="sc">$</span>Object <span class="sc">%in%</span> term),]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(term)</span></code></pre></div>
<p>For the terms that aren’t captured here, <code>fluxCo2</code>, <code>fluxH2o</code>, and <code>fluxTemp</code>
are self-explanatory. The flux components are</p>
<ul>
<li><code>turb</code>: Turbulent flux</li>
<li><code>stor</code>: Storage</li>
<li><code>nsae</code>: Net surface-atmosphere exchange</li>
</ul>
<p>The <code>variables</code> table contains the units for each field:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(flux<span class="sc">$</span>variables)</span></code></pre></div>
<p>Let’s plot some data! First, we’ll need to convert the time stamps
to an R date-time format (right now they’re just character fields).</p>
</div>
<div id="time-stamps" class="section level3 hasAnchor" number="4.6.4">
<h3 class="hasAnchor"><span class="header-section-number">4.6.4</span> Time stamps<a href="#time-stamps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>NEON sensor data come with time stamps for both the start and end of
the averaging period. Depending on the analysis you’re doing, you may
want to use one or the other; for general plotting, re-formatting, and
transformations, I prefer to use the start time, because there
are some small inconsistencies between data products in a few of the
end time stamps.</p>
<p>Note that <strong>all</strong> NEON data use UTC time, noted as
<code>tz="GMT"</code> in the code below. This is true across NEON’s instrumented,
observational, and airborne measurements. When working with NEON data,
it’s best to keep everything in UTC as much as possible, otherwise it’s
very easy to end up with data in mismatched times, which can cause
insidious and hard-to-detect problems. Be sure to include the <code>tz</code>
argument in all the lines of code below - if there is no time zone
specified, R will default to the local time zone it detects on your
operating system.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>timeB <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(flux<span class="sc">$</span>NIWO<span class="sc">$</span>timeBgn, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">format=</span><span class="st">&quot;%Y-%m-%dT%H:%M:%S&quot;</span>, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tz=</span><span class="st">&quot;GMT&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>flux<span class="sc">$</span>NIWO <span class="ot">&lt;-</span> <span class="fu">cbind</span>(timeB, flux<span class="sc">$</span>NIWO)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(flux<span class="sc">$</span>NIWO<span class="sc">$</span>data.fluxCo2.nsae.flux<span class="sc">~</span>timeB, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="st">&quot;.&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Date&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;CO2 flux&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="dv">1</span>, <span class="at">x=</span>timeB, <span class="at">format=</span><span class="st">&quot;%Y-%m-%d&quot;</span>)</span></code></pre></div>
<p>Like a lot of flux data, these data have some stray spikes, but there
is a clear diurnal pattern going into the growing season.</p>
<p>Let’s trim down to just two days of data to see a few other details.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(flux<span class="sc">$</span>NIWO<span class="sc">$</span>data.fluxCo2.nsae.flux<span class="sc">~</span>timeB, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">&quot;Date&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;CO2 flux&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">as.POSIXct</span>(<span class="st">&quot;2018-07-07&quot;</span>, <span class="at">tz=</span><span class="st">&quot;GMT&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.POSIXct</span>(<span class="st">&quot;2018-07-09&quot;</span>, <span class="at">tz=</span><span class="st">&quot;GMT&quot;</span>)),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="dv">1</span>, <span class="at">x=</span>timeB, <span class="at">format=</span><span class="st">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span></code></pre></div>
<p>Note the timing of C uptake; the UTC time zone is clear here, where
uptake occurs at times that appear to be during the night.</p>
</div>
<div id="merge-flux-data-with-other-sensor-data" class="section level3 hasAnchor" number="4.6.5">
<h3 class="hasAnchor"><span class="header-section-number">4.6.5</span> Merge flux data with other sensor data<a href="#merge-flux-data-with-other-sensor-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many of the data sets we would use to interpret and model flux data are
measured as part of the NEON project, but are not present in the eddy flux
data product bundle. In this section, we’ll download PAR data and merge
them with the flux data; the steps taken here can be applied to any of the
NEON instrumented (IS) data products.</p>
<div id="download-par-data" class="section level4 hasAnchor" number="4.6.5.1">
<h4 class="hasAnchor"><span class="header-section-number">4.6.5.1</span> Download PAR data<a href="#download-par-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To get NEON PAR data, use the <code>loadByProduct()</code> function from the
<code>neonUtilities</code> package. <code>loadByProduct()</code> takes the same inputs as
<code>zipsByProduct()</code>, but it loads the downloaded data directly into the
current R environment.</p>
<p>Let’s download PAR data matching the Niwot Ridge flux data. The inputs
needed are:</p>
<ul>
<li><code>dpID</code>: DP1.00024.001</li>
<li><code>site</code>: NIWO</li>
<li><code>startdate</code>: 2018-06</li>
<li><code>enddate</code>: 2018-07</li>
<li><code>package</code>: basic</li>
<li><code>avg</code>: 30</li>
</ul>
<p>The new input here is <code>avg=30</code>, which downloads only the 30-minute data.
Since the flux data are at a 30-minute resolution, we can save on
download time by disregarding the 1-minute data files (which are of course
30 times larger). The <code>avg</code> input can be left off if you want to download
all available averaging intervals.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">loadByProduct</span>(<span class="st">&quot;DP1.00024.001&quot;</span>, <span class="at">site=</span><span class="st">&quot;NIWO&quot;</span>, <span class="at">avg=</span><span class="dv">30</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">startdate=</span><span class="st">&quot;2018-06&quot;</span>, <span class="at">enddate=</span><span class="st">&quot;2018-07&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">package=</span><span class="st">&quot;basic&quot;</span>, <span class="at">check.size=</span>F)</span></code></pre></div>
<p><code>pr</code> is another named list, and again, metadata and units can be found in
the <code>variables</code> table. The <code>PARPAR_30min</code> table contains a <code>verticalPosition</code>
field. This field indicates the position on the tower, with 10 being the
first tower level, and 20, 30, etc going up the tower.</p>
</div>
<div id="join-par-to-flux-data" class="section level4 hasAnchor" number="4.6.5.2">
<h4 class="hasAnchor"><span class="header-section-number">4.6.5.2</span> Join PAR to flux data<a href="#join-par-to-flux-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We’ll connect PAR data from the tower top to the flux data.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pr.top <span class="ot">&lt;-</span> pr<span class="sc">$</span>PARPAR_30min[<span class="fu">which</span>(pr<span class="sc">$</span>PARPAR_30min<span class="sc">$</span>verticalPosition<span class="sc">==</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">max</span>(pr<span class="sc">$</span>PARPAR_30min<span class="sc">$</span>verticalPosition)),]</span></code></pre></div>
<p><code>loadByProduct()</code> automatically converts time stamps when it reads the
data, so here we just need to indicate which time field to use to
merge the flux and PAR data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>timeB <span class="ot">&lt;-</span> pr.top<span class="sc">$</span>startDateTime</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pr.top <span class="ot">&lt;-</span> <span class="fu">cbind</span>(timeB, pr.top)</span></code></pre></div>
<p>And merge the two datasets:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fx.pr <span class="ot">&lt;-</span> <span class="fu">merge</span>(pr.top, flux<span class="sc">$</span>NIWO, <span class="at">by=</span><span class="st">&quot;timeB&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fx.pr<span class="sc">$</span>data.fluxCo2.nsae.flux<span class="sc">~</span>fx.pr<span class="sc">$</span>PARMean,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="st">&quot;.&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;PAR&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;CO2 flux&quot;</span>)</span></code></pre></div>
<p>If you’re interested in data in the eddy covariance bundle besides the
net flux data, the rest of this tutorial will guide you through how to
get those data out of the bundle.</p>
</div>
</div>
<div id="vertical-profile-data-level-3" class="section level3 hasAnchor" number="4.6.6">
<h3 class="hasAnchor"><span class="header-section-number">4.6.6</span> Vertical profile data (Level 3)<a href="#vertical-profile-data-level-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Level 3 (<code>dp03</code>) data are the spatially interpolated profiles of
the rates of change of CO<sub>2</sub>, H<sub>2</sub>O, and temperature.
Extract the Level 3 data from the HDF5 file using <code>stackEddy()</code> with
the same syntax as for the Level 4 data.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prof <span class="ot">&lt;-</span> <span class="fu">stackEddy</span>(<span class="at">filepath=</span><span class="st">&quot;./data/filesToStack00200/&quot;</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">level=</span><span class="st">&quot;dp03&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(prof<span class="sc">$</span>NIWO))</span></code></pre></div>
</div>
<div id="un-interpolated-vertical-profile-data-level-2" class="section level3 hasAnchor" number="4.6.7">
<h3 class="hasAnchor"><span class="header-section-number">4.6.7</span> Un-interpolated vertical profile data (Level 2)<a href="#un-interpolated-vertical-profile-data-level-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Level 2 data are interpolated in time but not in space. They
contain the rates of change at the measurement heights.</p>
<p>Again, they can be extracted from the HDF5 files using <code>stackEddy()</code>
with the same syntax:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>prof.l2 <span class="ot">&lt;-</span> <span class="fu">stackEddy</span>(<span class="at">filepath=</span><span class="st">&quot;./data/filesToStack00200/&quot;</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">level=</span><span class="st">&quot;dp02&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(prof.l2<span class="sc">$</span>HARV))</span></code></pre></div>
<p>Note that here, as in the PAR data, there is a <code>verticalPosition</code> field.
It has the same meaning as in the PAR data, indicating the tower level of
the measurement.</p>
</div>
<div id="calibrated-raw-data-level-1" class="section level3 hasAnchor" number="4.6.8">
<h3 class="hasAnchor"><span class="header-section-number">4.6.8</span> Calibrated raw data (Level 1)<a href="#calibrated-raw-data-level-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Level 1 (<code>dp01</code>) data are calibrated, and aggregated in time, but
otherwise untransformed. Use Level 1 data for raw gas
concentrations and atmospheric stable isotopes.</p>
<p>Using <code>stackEddy()</code> to extract Level 1 data requires additional
inputs. The Level 1 files are too large to simply pull out all the
variables by default, and they include mutiple averaging intervals,
which can’t be merged. So two additional inputs are needed:</p>
<ul>
<li><code>avg</code>: The averaging interval to extract</li>
<li><code>var</code>: One or more variables to extract</li>
</ul>
<p>What variables are available, at what averaging intervals? Another
function in the <code>neonUtilities</code> package, <code>getVarsEddy()</code>, returns
a list of HDF5 file contents. It requires only one input, a filepath
to a single NEON HDF5 file:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">getVarsEddy</span>(<span class="st">&quot;./data/filesToStack00200/NEON.D01.HARV.DP4.00200.001.nsae.2018-07.basic.h5&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(vars))</span></code></pre></div>
<p>Inputs to <code>var</code> can be any values from the <code>name</code> field in the table
returned by <code>getVarsEddy()</code>. Let’s take a look at CO<sub>2</sub> and
H<sub>2</sub>O, <sup>13</sup>C in CO<sub>2</sub> and <sup>18</sup>O in
H<sub>2</sub>O, at 30-minute aggregation. Let’s look at Harvard Forest
for these data, since deeper canopies generally have more interesting
profiles:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>iso <span class="ot">&lt;-</span> <span class="fu">stackEddy</span>(<span class="at">filepath=</span><span class="st">&quot;./data/filesToStack00200/&quot;</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">level=</span><span class="st">&quot;dp01&quot;</span>, <span class="at">var=</span><span class="fu">c</span>(<span class="st">&quot;rtioMoleDryCo2&quot;</span>,<span class="st">&quot;rtioMoleDryH2o&quot;</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;dlta13CCo2&quot;</span>,<span class="st">&quot;dlta18OH2o&quot;</span>), <span class="at">avg=</span><span class="dv">30</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(iso<span class="sc">$</span>HARV))</span></code></pre></div>
<p>Let’s plot vertical profiles of CO<sub>2</sub> and <sup>13</sup>C in CO<sub>2</sub>
on a single day.</p>
<p>Here, for convenience, instead of converting the time stamps
to a time format, it’s easy to use the character format to extract the ones
we want using <code>grep()</code>. And discard the <code>verticalPosition</code> values that are
string values - those are the calibration gases.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>iso.d <span class="ot">&lt;-</span> iso<span class="sc">$</span>HARV[<span class="fu">grep</span>(<span class="st">&quot;2018-06-25&quot;</span>, iso<span class="sc">$</span>HARV<span class="sc">$</span>timeBgn, <span class="at">fixed=</span>T),]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>iso.d <span class="ot">&lt;-</span> iso.d[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">is.na</span>(<span class="fu">as.numeric</span>(iso.d<span class="sc">$</span>verticalPosition))),]</span></code></pre></div>
<p><code>ggplot</code> is well suited to these types of data, let’s use it to plot
the profiles.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iso.d, <span class="fu">aes</span>(<span class="at">y=</span>verticalPosition)) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x=</span>data.co2Stor.rtioMoleDryCo2.mean, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">group=</span>timeBgn, <span class="at">col=</span>timeBgn)) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;CO2&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Tower level&quot;</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="images/eddy_intro_50_1.png" width="420" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iso.d, <span class="fu">aes</span>(<span class="at">y=</span>verticalPosition)) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x=</span>data.isoCo2.dlta13CCo2.mean, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">group=</span>timeBgn, <span class="at">col=</span>timeBgn)) <span class="sc">+</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;d13C&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Tower level&quot;</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<pre><code>Warning message:
“Removed 55 rows containing missing values (geom_path).”</code></pre>
<p><img src="images/eddy_intro_51_1.png" width="420" /></p>
<p>The legends are omitted for space, see if you can work out the times
of day the different colors represent.</p>
</div>
<div id="convert-neon-flux-data-variables-to-ameriflux-fp-standard" class="section level3 hasAnchor" number="4.6.9">
<h3 class="hasAnchor"><span class="header-section-number">4.6.9</span> Convert NEON flux data variables to AmeriFlux FP standard<a href="#convert-neon-flux-data-variables-to-ameriflux-fp-standard" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Install and load packages</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Install NEONprocIS.base from GitHub, this package is a dependency of eddy4R.base</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="at">repo=</span><span class="st">&quot;NEONScience/NEON-IS-data-processing&quot;</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ref=</span><span class="st">&quot;master&quot;</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">subdir=</span><span class="st">&quot;pack/NEONprocIS.base&quot;</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dependencies=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">TRUE</span>)[<span class="dv">2</span>],</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">repos=</span><span class="fu">c</span>(BiocManager<span class="sc">::</span><span class="fu">repositories</span>(),   <span class="co"># for dependencies on Bioconductor packages</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;https://cran.rstudio.com/&quot;</span>)       <span class="co"># for CRAN</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Install eddy4R.base from GitHub</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="at">repo=</span><span class="st">&quot;NEONScience/eddy4R&quot;</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ref=</span><span class="st">&quot;master&quot;</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">subdir=</span><span class="st">&quot;pack/eddy4R.base&quot;</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dependencies=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">TRUE</span>)[<span class="dv">2</span>],</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">repos=</span><span class="fu">c</span>(BiocManager<span class="sc">::</span><span class="fu">repositories</span>(),   <span class="co"># for dependencies on Bioconductor packages</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;https://cran.rstudio.com/&quot;</span>)       <span class="co"># for CRAN</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>packReq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rhdf5&quot;</span>, <span class="st">&quot;eddy4R.base&quot;</span>, <span class="st">&quot;jsonlite&quot;</span>, <span class="st">&quot;lubridate&quot;</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(packReq, <span class="cf">function</span>(x) {</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(x)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(x)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  }})</span></code></pre></div>
<p>Select your site of interest from the list of NEON sites below.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="st">&quot;KONZ&quot;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&quot;BARR&quot;,&quot;CLBJ&quot;,&quot;MLBS&quot;,&quot;DSNY&quot;,&quot;NIWO&quot;,&quot;ORNL&quot;,&quot;OSBS&quot;,</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&quot;SCBI&quot;,&quot;LENO&quot;,&quot;TALL&quot;,&quot;CPER&quot;,&quot;BART&quot;,&quot;HARV&quot;,&quot;BLAN&quot;,</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&quot;SERC&quot;,&quot;JERC&quot;,&quot;GUAN&quot;,&quot;LAJA&quot;,&quot;STEI&quot;,&quot;TREE&quot;,&quot;UNDE&quot;,</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&quot;KONA&quot;,&quot;KONZ&quot;,&quot;UKFS&quot;,&quot;GRSM&quot;,&quot;DELA&quot;,&quot;DCFS&quot;,&quot;NOGP&quot;,</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&quot;WOOD&quot;,&quot;RMNP&quot;,&quot;OAES&quot;,&quot;YELL&quot;,&quot;MOAB&quot;,&quot;STER&quot;,&quot;JORN&quot;,</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&quot;SRER&quot;,&quot;ONAQ&quot;,&quot;ABBY&quot;,&quot;WREF&quot;,&quot;SJER&quot;,&quot;SOAP&quot;,&quot;TEAK&quot;,</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&quot;TOOL&quot;,&quot;BONA&quot;,&quot;DEJU&quot;,&quot;HEAL&quot;,&quot;PUUM&quot;</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<p>If you would like to download a set range of dates, define the following paramemters. If these are not defined, it will default to the entire record at the site</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define start and end dates, optional, defaults to entire period of site operation. Use %Y-%m-%d format.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dateBgn <span class="ot">&lt;-</span> <span class="st">&quot;2020-03-01&quot;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>dateEnd <span class="ot">&lt;-</span> <span class="st">&quot;2020-05-31&quot;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data package from the portal</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>Pack <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;expanded&#39;</span>)[<span class="dv">1</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#The version data for the FP standard conversion processing</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>ver <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;v&quot;</span>,<span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="st">&quot;%Y%m%dT%H%m&quot;</span>))</span></code></pre></div>
<p>Specify Download directory for HDF5 files from the NEON data portal and output directory to save the resulting csv files. Change save paths to where you want the files on your computer.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#download directory</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>DirDnld<span class="ot">=</span><span class="fu">tempdir</span>()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Output directory, change this to where you want to save the output csv</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>DirOutBase <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">&quot;~/eddy/data/Ameriflux/&quot;</span>,ver)</span></code></pre></div>
<p>Specify Data Product number, for the Bundled Eddy-Covariance files, this is DP4.00200.001</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DP number</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>dpID <span class="ot">&lt;-</span> <span class="st">&#39;DP4.00200.001&#39;</span></span></code></pre></div>
<p>Get metadata from Ameriflux Site Info BADM sheets for the site of interest</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Grab a list of all Ameriflux sites, containing site ID and site description</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  sites_web <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(<span class="st">&quot;http://ameriflux-data.lbl.gov/AmeriFlux/SiteSearch.svc/SiteList/AmeriFlux&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Grab only NEON sites</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  sitesNeon <span class="ot">&lt;-</span> sites_web[<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">&quot;NEON.*&quot;</span>,site), <span class="at">x =</span> sites_web<span class="sc">$</span>SITE_NAME),] <span class="co">#For all NEON sites</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  siteNeon <span class="ot">&lt;-</span> sites_web[<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">&quot;NEON.*&quot;</span>,site), <span class="at">x =</span> sites_web<span class="sc">$</span>SITE_NAME),]</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  metaSite <span class="ot">&lt;-</span> <span class="fu">lapply</span>(siteNeon<span class="sc">$</span>SITE_ID, <span class="cf">function</span>(x) {</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    pathSite <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;http://ameriflux-data.lbl.gov/BADM/Anc/SiteInfo/&quot;</span>,x)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(pathSite)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    }) </span></code></pre></div>
<p>Use Ameriflux site IDs to name metadata lists</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use NEON ID as list name</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(metaSite) <span class="ot">&lt;-</span> site </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Use Ameriflux site ID as list name  </span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#names(metaSite) &lt;- sitesNeon$SITE_ID </span></span></code></pre></div>
<p>Check if dateBgn is defined, if not make it the initial operations date “IOCR” of the site</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">exists</span>(<span class="st">&quot;dateBgn&quot;</span>) <span class="sc">||</span> <span class="fu">is.na</span>(dateBgn) <span class="sc">||</span> <span class="fu">is.null</span>(dateBgn)){</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    dateBgn <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(metaSite[[site]]<span class="sc">$</span>values<span class="sc">$</span>GRP_FLUX_MEASUREMENTS[[<span class="dv">1</span>]]<span class="sc">$</span>FLUX_MEASUREMENTS_DATE_START, <span class="st">&quot;%Y%m%d&quot;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    dateBgn <span class="ot">&lt;-</span> dateBgn</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  }<span class="co">#End of checks for missing dateBgn</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Check if dateEnd is defined, if not make it the system date</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">exists</span>(<span class="st">&quot;dateEnd&quot;</span>) <span class="sc">||</span> <span class="fu">is.na</span>(dateEnd) <span class="sc">||</span> <span class="fu">is.null</span>(dateEnd)){</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    dateEnd <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    dateEnd <span class="ot">&lt;-</span> dateEnd</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  }<span class="co">#End of checks for missing dateEnd</span></span></code></pre></div>
<p>Grab the UTC time offset from the Ameriflux API</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>  timeOfstUtc <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(metaSite[[site]]<span class="sc">$</span>values<span class="sc">$</span>GRP_UTC_OFFSET[[<span class="dv">1</span>]]<span class="sc">$</span>UTC_OFFSET)</span></code></pre></div>
<p>Create the date sequence</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>  setDate <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(dateBgn), <span class="at">to =</span> <span class="fu">as.Date</span>(dateEnd), <span class="at">by =</span> <span class="st">&quot;month&quot;</span>)</span></code></pre></div>
<p>Start processing the site time range specified, verify that the site and date range are specified as intended</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>  msg <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Starting Ameriflux FP standard conversion processing workflow for &quot;</span>, site, <span class="st">&quot; for &quot;</span>, dateBgn, <span class="st">&quot; to &quot;</span>, dateEnd)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(msg)</span></code></pre></div>
<p>Create output directory by checking if the download directory exists and create it if not</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">dir.exists</span>(DirDnld) <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="fu">dir.create</span>(DirDnld, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Append the site to the base output directory</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  DirOut <span class="ot">&lt;-</span> <span class="fu">paste0</span>(DirOutBase, <span class="st">&quot;/&quot;</span>, siteNeon<span class="sc">$</span>SITE_ID)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Check if directory exists and create if not</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(DirOut)) <span class="fu">dir.create</span>(DirOut, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Download and extract data</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Initialize data List</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  dataList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Read data from the API</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  dataList <span class="ot">&lt;-</span> <span class="fu">lapply</span>(setDate, <span class="cf">function</span>(x) {</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># year &lt;- lubridate::year(x)</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mnth &lt;- lubridate::month(x)</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    date <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(x, <span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">&quot;[0-9]{4}&quot;</span>, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;[0-9]{2}&quot;</span>))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>(neonUtilities<span class="sc">::</span><span class="fu">zipsByProduct</span>(<span class="at">dpID =</span> dpID, <span class="at">site =</span> site, <span class="at">startdate =</span> date, <span class="at">enddate =</span> date, <span class="at">package =</span> <span class="st">&quot;basic&quot;</span>, <span class="at">savepath =</span> DirDnld, <span class="at">check.size =</span> <span class="cn">FALSE</span>), <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste0</span>(DirDnld, <span class="st">&quot;/filesToStack00200&quot;</span>))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    utils<span class="sc">::</span><span class="fu">unzip</span>(<span class="fu">paste0</span>(DirDnld, <span class="st">&quot;/filesToStack00200/&quot;</span>, files[<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="fu">paste0</span>(site,<span class="st">&quot;.*.&quot;</span>, date, <span class="st">&quot;.*.zip&quot;</span>), <span class="at">x =</span> files)]), <span class="at">exdir =</span> <span class="fu">paste0</span>(DirDnld, <span class="st">&quot;/filesToStack00200&quot;</span>))</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste0</span>(DirDnld, <span class="st">&quot;/filesToStack00200&quot;</span>))</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    dataIdx <span class="ot">&lt;-</span> rhdf5<span class="sc">::</span><span class="fu">h5read</span>(<span class="at">file =</span> <span class="fu">paste0</span>(DirDnld, <span class="st">&quot;/filesToStack00200/&quot;</span>, <span class="fu">max</span>(files[<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="fu">paste0</span>(site,<span class="st">&quot;.*.&quot;</span>, date,<span class="st">&quot;.*.h5&quot;</span>), <span class="at">x =</span> files)])), <span class="at">name =</span> <span class="fu">paste0</span>(site, <span class="st">&quot;/&quot;</span>))</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(dataIdx)){ </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>       dataIdx<span class="sc">$</span>dp0p <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>       dataIdx<span class="sc">$</span>dp02 <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>       dataIdx<span class="sc">$</span>dp03 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>       dataIdx<span class="sc">$</span>dp01<span class="sc">$</span>ucrt <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>       dataIdx<span class="sc">$</span>dp04<span class="sc">$</span>ucrt <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>       dataIdx<span class="sc">$</span>dp01<span class="sc">$</span>data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(dataIdx<span class="sc">$</span>dp01<span class="sc">$</span>data,<span class="at">FUN=</span><span class="cf">function</span>(var){ </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>         nameTmi <span class="ot">&lt;-</span> <span class="fu">names</span>(var) </span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>         var <span class="ot">&lt;-</span> var[<span class="fu">grepl</span>(<span class="st">&#39;_30m&#39;</span>,nameTmi)] </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>         <span class="fu">return</span>(var)})</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>       dataIdx<span class="sc">$</span>dp01<span class="sc">$</span>qfqm <span class="ot">&lt;-</span> <span class="fu">lapply</span>(dataIdx<span class="sc">$</span>dp01<span class="sc">$</span>qfqm,<span class="at">FUN=</span><span class="cf">function</span>(var){ </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>         nameTmi <span class="ot">&lt;-</span> <span class="fu">names</span>(var)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>         var <span class="ot">&lt;-</span> var[<span class="fu">grepl</span>(<span class="st">&#39;_30m&#39;</span>,nameTmi)]</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>         <span class="fu">return</span>(var)})</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(dataIdx)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  })</span></code></pre></div>
<p>Add names to list for year/month combinations</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dataList) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(setDate),<span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>,lubridate<span class="sc">::</span><span class="fu">month</span>(setDate)))</span></code></pre></div>
<p>Remove NULL elements from list</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dataList <span class="ot">&lt;-</span> dataList[<span class="fu">vapply</span>(dataList, <span class="fu">Negate</span>(is.null), <span class="cn">NA</span>)]</span></code></pre></div>
<p>Determine tower horizontal &amp; vertical indices</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Find the tower top level by looking at the vertical index of the turbulent CO2 concentration measurements </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    LvlTowr <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">&quot;_30m&quot;</span>, <span class="fu">names</span>(dataList[[<span class="dv">1</span>]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>co2Turb), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    LvlTowr <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> LvlTowr, <span class="at">pattern =</span> <span class="st">&quot;_30m&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#get tower top level</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    LvlTop <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(LvlTowr,<span class="st">&quot;&quot;</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    LvlTop <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">as.numeric</span>(LvlTop[[<span class="dv">1</span>]][<span class="dv">6</span>])</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Ameriflux vertical levels based off of https://ameriflux.lbl.gov/data/aboutdata/data-variables/ section 3.3.1 &quot;Indices must be in order, starting with the highest.&quot;</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    idxVerAmfx <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> LvlTop, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#get the sequence from top to first level</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    LvlMeas <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="at">from =</span> LvlTop, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Recreate NEON naming conventions</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    LvlMeas <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;000_0&quot;</span>,LvlMeas,<span class="st">&quot;0&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Give NEON naming conventions to Ameriflux vertical levels</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(idxVerAmfx) <span class="ot">&lt;-</span> LvlMeas</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Ameriflux horizontal index</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    idxHorAmfx <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div>
<p>Subset to the Ameriflux variables to convert</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>    dataListFlux <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(dataList), <span class="cf">function</span>(x) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;TIMESTAMP_START&quot;</span> <span class="ot">=</span> <span class="fu">as.POSIXlt</span>(dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxCo2<span class="sc">$</span>turb<span class="sc">$</span>timeBgn, <span class="at">format=</span><span class="st">&quot;%Y-%m-%dT%H:%M:%OSZ&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;GMT&quot;</span>),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;TIMESTAMP_END&quot;</span> <span class="ot">=</span> <span class="fu">as.POSIXlt</span>(dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxCo2<span class="sc">$</span>turb<span class="sc">$</span>timeEnd, <span class="at">format=</span><span class="st">&quot;%Y-%m-%dT%H:%M:%OSZ&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;GMT&quot;</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># &quot;TIMESTAMP_START&quot; = strftime(as.POSIXlt(dataList[[x]][[idxSite]]$dp04$data$fluxCo2$turb$timeBgn, format=&quot;%Y-%m-%dT%H:%M:%OSZ&quot;), format = &quot;%Y%m%d%H%M&quot;),</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># &quot;TIMESTAMP_END&quot; = strftime(as.POSIXlt(dataList[[x]][[idxSite]]$dp04$data$fluxCo2$turb$timeEnd, format=&quot;%Y-%m-%dT%H:%M:%OSZ&quot;) + 60, format = &quot;%Y%m%d%H%M&quot;),</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;FC&quot;</span><span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxCo2<span class="sc">$</span>turb<span class="sc">$</span>flux,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;SC&quot;</span><span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxCo2<span class="sc">$</span>stor<span class="sc">$</span>flux,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;NEE&quot;</span><span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxCo2<span class="sc">$</span>nsae<span class="sc">$</span>flux,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;LE&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxH2o<span class="sc">$</span>turb<span class="sc">$</span>flux,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;SLE&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxH2o<span class="sc">$</span>stor<span class="sc">$</span>flux,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;USTAR&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxMome<span class="sc">$</span>turb<span class="sc">$</span>veloFric,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;H&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxTemp<span class="sc">$</span>turb<span class="sc">$</span>flux,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;SH&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>fluxTemp<span class="sc">$</span>stor<span class="sc">$</span>flux,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;FETCH_90&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>foot<span class="sc">$</span>stat<span class="sc">$</span>distXaxs90,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;FETCH_MAX&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>foot<span class="sc">$</span>stat<span class="sc">$</span>distXaxsMax,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;V_SIGMA&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>data<span class="sc">$</span>foot<span class="sc">$</span>stat<span class="sc">$</span>veloYaxsHorSd,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">#&quot;W_SIGMA&quot; = dataList[[x]]$dp04$data$foot$stat$veloZaxsHorSd,</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;CO2_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>co2Turb[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryCo2<span class="sc">$</span>mean,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;H2O_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>h2oTurb[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryH2o<span class="sc">$</span>mean,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfFinlH2oTurbFrt00Samp&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>h2oTurb[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>frt00Samp<span class="sc">$</span>qfFinl,</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfH2O_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>h2oTurb[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryH2o<span class="sc">$</span>qfFinl,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfCO2_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>co2Turb[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryCo2<span class="sc">$</span>qfFinl,</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfSC&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>qfqm<span class="sc">$</span>fluxCo2<span class="sc">$</span>stor<span class="sc">$</span>qfFinl,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfSLE&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>qfqm<span class="sc">$</span>fluxH2o<span class="sc">$</span>stor<span class="sc">$</span>qfFinl,</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfSH&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp04<span class="sc">$</span>qfqm<span class="sc">$</span>fluxTemp<span class="sc">$</span>stor<span class="sc">$</span>qfFinl,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfT_SONIC&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>soni[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>tempSoni<span class="sc">$</span>qfFinl,</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;qfWS_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>soni[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>veloXaxsYaxsErth<span class="sc">$</span>qfFinl,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rbind.data.frame</span>(<span class="fu">lapply</span>(<span class="fu">names</span>(idxVerAmfx), <span class="cf">function</span>(y) {</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tryCatch</span>({rlog<span class="sc">$</span><span class="fu">debug</span>(y)}, <span class="at">error=</span><span class="cf">function</span>(cond){<span class="fu">print</span>(y)})</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>          rpt <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;CO2_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_2&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>co2Stor[[<span class="fu">paste0</span>(y,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryCo2<span class="sc">$</span>mean</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;H2O_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_2&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>h2oStor[[<span class="fu">paste0</span>(y,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryH2o<span class="sc">$</span>mean</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;CO2_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_3&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>isoCo2[[<span class="fu">paste0</span>(y,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryCo2<span class="sc">$</span>mean</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;H2O_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_3&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>isoCo2[[<span class="fu">paste0</span>(y,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryH2o<span class="sc">$</span>mean</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;qfCO2_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_2&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>co2Stor[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryCo2<span class="sc">$</span>qfFinl</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;qfH2O_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_2&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>h2oStor[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryH2o<span class="sc">$</span>qfFinl</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;qfCO2_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_3&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>isoCo2[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryCo2<span class="sc">$</span>qfFinl</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>          rpt[[<span class="fu">paste0</span>(<span class="st">&quot;qfH2O_1_&quot;</span>,idxVerAmfx[y],<span class="st">&quot;_3&quot;</span>)]] <span class="ot">&lt;-</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>qfqm<span class="sc">$</span>isoH2o[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>rtioMoleDryH2o<span class="sc">$</span>qfFinl</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>          rpt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(rpt)</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(rpt)</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>        )),</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;WS_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>soni[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>veloXaxsYaxsErth<span class="sc">$</span>mean,</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;WS_MAX_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>soni[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>veloXaxsYaxsErth<span class="sc">$</span>max,</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;WD_1_1_1&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>soni[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>angZaxsErth<span class="sc">$</span>mean,</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;T_SONIC&quot;</span> <span class="ot">=</span> dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>soni[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>tempSoni<span class="sc">$</span>mean,</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;T_SONIC_SIGMA&quot;</span> <span class="ot">=</span> base<span class="sc">::</span><span class="fu">sqrt</span>(dataList[[x]]<span class="sc">$</span>dp01<span class="sc">$</span>data<span class="sc">$</span>soni[[<span class="fu">paste0</span>(LvlTowr,<span class="st">&quot;_30m&quot;</span>)]]<span class="sc">$</span>tempSoni<span class="sc">$</span>mean)</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>        , <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(dataListFlux) <span class="ot">&lt;-</span> <span class="fu">names</span>(dataList)</span></code></pre></div>
<p>Combine the monthly data into a single dataframe, remove lists and clean memory</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>    dataDfFlux <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind.data.frame,dataListFlux)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">c</span>(<span class="st">&quot;dataListFlux&quot;</span>,<span class="st">&quot;dataList&quot;</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gc</span>()</span></code></pre></div>
<p>Regularize timeseries to 30 minutes in case timestamps are missing from NEON files due to processing errors</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>    timeRglr <span class="ot">&lt;-</span> eddy4R.base<span class="sc">::</span><span class="fu">def.rglr</span>(<span class="at">timeMeas =</span> <span class="fu">as.POSIXlt</span>(dataDfFlux<span class="sc">$</span>TIMESTAMP_START), <span class="at">dataMeas =</span> dataDfFlux, <span class="at">BgnRglr =</span> <span class="fu">as.POSIXlt</span>(dataDfFlux<span class="sc">$</span>TIMESTAMP_START[<span class="dv">1</span>]), <span class="at">EndRglr =</span> <span class="fu">as.POSIXlt</span>(dataDfFlux<span class="sc">$</span>TIMESTAMP_END[<span class="fu">length</span>(dataDfFlux<span class="sc">$</span>TIMESTAMP_END)]), <span class="at">TzRglr =</span> <span class="st">&quot;UTC&quot;</span>, <span class="at">FreqRglr =</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">30</span>))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Reassign data to data.frame</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    dataDfFlux <span class="ot">&lt;-</span> timeRglr<span class="sc">$</span>dataRglr</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Format timestamps</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>TIMESTAMP_START <span class="ot">&lt;-</span> <span class="fu">strftime</span>(timeRglr<span class="sc">$</span>timeRglr <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">hours</span>(timeOfstUtc), <span class="at">format =</span> <span class="st">&quot;%Y%m%d%H%M&quot;</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>TIMESTAMP_END <span class="ot">&lt;-</span> <span class="fu">strftime</span>(timeRglr<span class="sc">$</span>timeRglr <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">hours</span>(timeOfstUtc) <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">minutes</span>(<span class="dv">30</span>), <span class="at">format =</span> <span class="st">&quot;%Y%m%d%H%M&quot;</span>)</span></code></pre></div>
<p>Define validation times, and remove this data from the dataset. At NEON sites, validations with a series of gasses of known concentration are run every 23.5 hours. These values are used to correct for measurment drift and are run every 23.5 hours to achive daily resolution while also spreading the impact of lost measurements throughout the day.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Remove co2Turb and h2oTurb data based off of qfFlow (qfFinl frt00)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>FC[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfCO2_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>LE[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfH2O_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>USTAR[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfWS_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>H[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfT_SONIC_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>SC[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfSC <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>SLE[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfSLE <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>SH[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfSH <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>T_SONIC[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfT_SONIC_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>T_SONIC_SIGMA[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfT_SONIC_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>WS_1_1_1[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfWS_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>WS_MAX_1_1_1[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfWS_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>WD_1_1_1[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfWS_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>H2O_1_1_1[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfH2O_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    dataDfFlux<span class="sc">$</span>CO2_1_1_1[(<span class="fu">which</span>(dataDfFlux<span class="sc">$</span>qfCO2_1_1_1 <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(idxVerAmfx, <span class="cf">function</span>(x){</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>      <span class="co">#x &lt;- 1</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>      dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;H2O_1_&quot;</span>,x,<span class="st">&quot;_2&quot;</span>)]][(<span class="fu">which</span>(dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;qfH2O_1_&quot;</span>,x,<span class="st">&quot;_2&quot;</span>)]] <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>      dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;H2O_1_&quot;</span>,x,<span class="st">&quot;_3&quot;</span>)]][(<span class="fu">which</span>(dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;qfH2O_1_&quot;</span>,x,<span class="st">&quot;_3&quot;</span>)]] <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>      dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;CO2_1_&quot;</span>,x,<span class="st">&quot;_2&quot;</span>)]][(<span class="fu">which</span>(dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;qfCO2_1_&quot;</span>,x,<span class="st">&quot;_2&quot;</span>)]] <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>      dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;CO2_1_&quot;</span>,x,<span class="st">&quot;_3&quot;</span>)]][(<span class="fu">which</span>(dataDfFlux[[<span class="fu">paste0</span>(<span class="st">&quot;qfCO2_1_&quot;</span>,x,<span class="st">&quot;_3&quot;</span>)]] <span class="sc">==</span> <span class="dv">1</span>))] <span class="ot">&lt;&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    })</span></code></pre></div>
<p>Remove quality flagging variables from output</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>    setIdxQf <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;qf&quot;</span>, <span class="fu">names</span>(dataDfFlux))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    dataDfFlux[,setIdxQf] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Set range thresholds</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#assign list</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    Rng <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    Rng<span class="sc">$</span>Min <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;FC&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">100</span>,            <span class="co">#[umol m-2 s-1]</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;SC&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">100</span>,            <span class="co">#[umol m-2 s-1]</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;NEE&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">100</span>,            <span class="co">#[umol m-2 s-1]</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;LE&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">500</span>,            <span class="co">#[W m-2]</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;H&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">500</span>,             <span class="co">#[W m-2]</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;USTAR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,            <span class="co">#[m s-1]</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;CO2&quot;</span> <span class="ot">=</span> <span class="dv">200</span>,            <span class="co">#[umol mol-1]</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;H2O&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,              <span class="co">#[mmol mol-1]</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;WS_1_1_1&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,         <span class="co">#[m s-1]</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;WS_MAX_1_1_1&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,     <span class="co">#[m s-1]</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;WD_1_1_1&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">0.1</span>,      <span class="co">#[deg]</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;T_SONIC&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">55.0</span>       <span class="co">#[C]</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>Set Max thresholds</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>    Rng<span class="sc">$</span>Max <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;FC&quot;</span> <span class="ot">=</span> <span class="dv">100</span>,            <span class="co">#[umol m-2 s-1]</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;SC&quot;</span> <span class="ot">=</span> <span class="dv">100</span>,            <span class="co">#[umol m-2 s-1]</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;NEE&quot;</span> <span class="ot">=</span> <span class="dv">100</span>,            <span class="co">#[umol m-2 s-1]</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;LE&quot;</span> <span class="ot">=</span> <span class="dv">1000</span>,            <span class="co">#[W m-2]</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;H&quot;</span> <span class="ot">=</span> <span class="dv">1000</span>,             <span class="co">#[W m-2]</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;USTAR&quot;</span> <span class="ot">=</span> <span class="dv">5</span>,            <span class="co">#[m s-1]</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;CO2&quot;</span> <span class="ot">=</span> <span class="dv">800</span>,            <span class="co">#[umol mol-1]</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;H2O&quot;</span> <span class="ot">=</span> <span class="dv">100</span>,              <span class="co">#[mmol mol-1]</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;WS_1_1_1&quot;</span> <span class="ot">=</span> <span class="dv">50</span>,         <span class="co">#[m s-1]</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;WS_MAX_1_1_1&quot;</span> <span class="ot">=</span> <span class="dv">50</span>,     <span class="co">#[m s-1]</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;WD_1_1_1&quot;</span> <span class="ot">=</span> <span class="dv">360</span>,      <span class="co">#[deg]</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;T_SONIC&quot;</span> <span class="ot">=</span> <span class="fl">45.0</span>       <span class="co">#[C]</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>Grab all CO2/H2O columns to apply same thresholds, replace missing values with -9999</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>    nameCO2 <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;CO2&quot;</span>,<span class="fu">names</span>(dataDfFlux),<span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    nameH2O <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;H2O&quot;</span>,<span class="fu">names</span>(dataDfFlux),<span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Apply the CO2/H2O threshold to all variables in HOR_VER_REP</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    Rng<span class="sc">$</span>Min[nameCO2] <span class="ot">&lt;-</span> Rng<span class="sc">$</span>Min<span class="sc">$</span>CO2</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    Rng<span class="sc">$</span>Min[nameH2O] <span class="ot">&lt;-</span> Rng<span class="sc">$</span>Min<span class="sc">$</span>H2O</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    Rng<span class="sc">$</span>Max[nameCO2] <span class="ot">&lt;-</span> Rng<span class="sc">$</span>Max<span class="sc">$</span>CO2</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    Rng<span class="sc">$</span>Max[nameH2O] <span class="ot">&lt;-</span> Rng<span class="sc">$</span>Max<span class="sc">$</span>H2O</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Apply the range test to the output, and replace values with NaN</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="fu">names</span>(dataDfFlux), <span class="cf">function</span>(x) {</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>      dataDfFlux[<span class="fu">which</span>(dataDfFlux[,x]<span class="sc">&lt;</span>Rng<span class="sc">$</span>Min[[x]] <span class="sc">|</span> dataDfFlux[,x]<span class="sc">&gt;</span>Rng<span class="sc">$</span>Max[[x]]),x] <span class="ot">&lt;&lt;-</span> <span class="cn">NaN</span>})</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Delete any NEE that have either FC or SC removed</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    dataDfFlux[<span class="fu">is.na</span>(dataDfFlux<span class="sc">$</span>FC) <span class="sc">|</span> <span class="fu">is.na</span>(dataDfFlux<span class="sc">$</span>SC),<span class="st">&quot;NEE&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NaN</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Change NA to -9999</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    dataDfFlux[<span class="fu">is.na</span>(dataDfFlux)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">9999</span></span></code></pre></div>
<p>Write output data to csv</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Create output filename based off of Ameriflux file naming convention</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    nameFileOut <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">paste0</span>(DirOut,<span class="st">&quot;/&quot;</span>,siteNeon<span class="sc">$</span>SITE_ID,<span class="st">&#39;_HH_&#39;</span>,dataDfFlux<span class="sc">$</span>TIMESTAMP_START[<span class="dv">1</span>],<span class="st">&#39;_&#39;</span>,utils<span class="sc">::</span><span class="fu">tail</span>(dataDfFlux<span class="sc">$</span>TIMESTAMP_END,<span class="at">n=</span><span class="dv">1</span>),<span class="st">&#39;_flux.csv&#39;</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Write output to .csv</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.csv</span>(<span class="at">x =</span> dataDfFlux, <span class="at">file =</span> nameFileOut, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Clean up environment</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list=</span><span class="st">&quot;dataDfFlux&quot;</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gc</span>()</span></code></pre></div>
</div>
</div>
<div id="exercises-1" class="section level2 hasAnchor" number="4.7">
<h2 class="hasAnchor"><span class="header-section-number">4.7</span> Exercises<a href="#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="computational" class="section level3 hasAnchor" number="4.7.1">
<h3 class="hasAnchor"><span class="header-section-number">4.7.1</span> Computational<a href="#computational" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>NEON data are submitted to AmeriFlux quarterly after one year of non-quality flagged or otherwise missing data are available. Use the workflow above to extend the data coverage of an already submitted NEON site by downloading existing data from the AmeriFlux website and recently published HDF5 files from the NEON data portal. Process the NEON data such that it is in AmeriFlux format and plot the entire timerseries.</li>
</ol>
<p><em>Hint: NEON sites start with US-x</em></p>
<ol start="2" style="list-style-type: decimal">
<li>Using metScanR package, find co-located NEON and AmeriFlux sites. Download data for an overlapping time period, and compare FC and H values by making a scatter plot and seeing how far off the data are from a 1:1 line.</li>
</ol>
<!--chapter:end:06-Fluxes_and_Inter-operability.Rmd-->
</div>
</div>
</div>
<div id="neon-aop" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> NEON AOP<a href="#neon-aop" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="hyperspectral-remote-sensing" class="section level2 hasAnchor" number="5.1">
<h2 class="hasAnchor"><span class="header-section-number">5.1</span> Hyperspectral Remote Sensing<a href="#hyperspectral-remote-sensing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="learning-objectives-2" class="section level3 hasAnchor" number="5.1.1">
<h3 class="hasAnchor"><span class="header-section-number">5.1.1</span> Learning Objectives<a href="#learning-objectives-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="mapping-the-invisible" class="section level4 hasAnchor" number="5.1.1.1">
<h4 class="hasAnchor"><span class="header-section-number">5.1.1.1</span> Mapping the Invisible<a href="#mapping-the-invisible" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="about-hyperspectral-remote-sensing-data" class="section level3 hasAnchor" number="5.1.2">
<h3 class="hasAnchor"><span class="header-section-number">5.1.2</span> About Hyperspectral Remote Sensing Data<a href="#about-hyperspectral-remote-sensing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="key-metadata-for-hyperspectral-data" class="section level2 hasAnchor" number="5.2">
<h2 class="hasAnchor"><span class="header-section-number">5.2</span> Key Metadata for Hyperspectral Data<a href="#key-metadata-for-hyperspectral-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bands-and-wavelengths" class="section level3 hasAnchor" number="5.2.1">
<h3 class="hasAnchor"><span class="header-section-number">5.2.1</span> Bands and Wavelengths<a href="#bands-and-wavelengths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="spectral-resolution" class="section level3 hasAnchor" number="5.2.2">
<h3 class="hasAnchor"><span class="header-section-number">5.2.2</span> Spectral Resolution<a href="#spectral-resolution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="full-width-half-max-fwhm" class="section level3 hasAnchor" number="5.2.3">
<h3 class="hasAnchor"><span class="header-section-number">5.2.3</span> Full Width Half Max (FWHM)<a href="#full-width-half-max-fwhm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="intro-to-working-with-hyperspectral-remote-sensing-data-in-hdf5-format" class="section level2 hasAnchor" number="5.3">
<h2 class="hasAnchor"><span class="header-section-number">5.3</span> Intro to Working with Hyperspectral Remote Sensing Data in HDF5 Format<a href="#intro-to-working-with-hyperspectral-remote-sensing-data-in-hdf5-format" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="learning-objectives-3" class="section level3 hasAnchor" number="5.3.1">
<h3 class="hasAnchor"><span class="header-section-number">5.3.1</span> Learning Objectives<a href="#learning-objectives-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="r-libraries-to-install" class="section level3 hasAnchor" number="5.3.2">
<h3 class="hasAnchor"><span class="header-section-number">5.3.2</span> R Libraries to Install:<a href="#r-libraries-to-install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="data-to-download" class="section level3 hasAnchor" number="5.3.3">
<h3 class="hasAnchor"><span class="header-section-number">5.3.3</span> Data to Download<a href="#data-to-download" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="about-hyperspectral-remote-sensing-data-1" class="section level2 hasAnchor" number="5.4">
<h2 class="hasAnchor"><span class="header-section-number">5.4</span> About Hyperspectral Remote Sensing Data<a href="#about-hyperspectral-remote-sensing-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="read-hdf5-data-into-r" class="section level2 hasAnchor" number="5.5">
<h2 class="hasAnchor"><span class="header-section-number">5.5</span> Read HDF5 data into R<a href="#read-hdf5-data-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bands-and-wavelengths-1" class="section level3 hasAnchor" number="5.5.1">
<h3 class="hasAnchor"><span class="header-section-number">5.5.1</span> Bands and Wavelengths<a href="#bands-and-wavelengths-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="a-note-about-data-slicing-in-hdf5" class="section level3 hasAnchor" number="5.5.2">
<h3 class="hasAnchor"><span class="header-section-number">5.5.2</span> A Note About Data Slicing in HDF5<a href="#a-note-about-data-slicing-in-hdf5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="arrays-vs.-matrices" class="section level3 hasAnchor" number="5.5.3">
<h3 class="hasAnchor"><span class="header-section-number">5.5.3</span> Arrays vs. Matrices<a href="#arrays-vs.-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="dimensions-in-arrays" class="section level3 hasAnchor" number="5.5.4">
<h3 class="hasAnchor"><span class="header-section-number">5.5.4</span> Dimensions in Arrays<a href="#dimensions-in-arrays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="data-ignore-value" class="section level3 hasAnchor" number="5.5.5">
<h3 class="hasAnchor"><span class="header-section-number">5.5.5</span> Data Ignore Value<a href="#data-ignore-value" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="reflectance-values-and-image-stretch" class="section level3 hasAnchor" number="5.5.6">
<h3 class="hasAnchor"><span class="header-section-number">5.5.6</span> Reflectance Values and Image Stretch<a href="#reflectance-values-and-image-stretch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="transpose-image" class="section level3 hasAnchor" number="5.5.7">
<h3 class="hasAnchor"><span class="header-section-number">5.5.7</span> Transpose Image<a href="#transpose-image" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="create-a-georeferenced-raster" class="section level2 hasAnchor" number="5.6">
<h2 class="hasAnchor"><span class="header-section-number">5.6</span> Create a Georeferenced Raster<a href="#create-a-georeferenced-raster" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="define-raster-crs" class="section level3 hasAnchor" number="5.6.1">
<h3 class="hasAnchor"><span class="header-section-number">5.6.1</span> Define Raster CRS<a href="#define-raster-crs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="challenge-work-with-rasters" class="section level3 hasAnchor" number="5.6.2">
<h3 class="hasAnchor"><span class="header-section-number">5.6.2</span> Challenge: Work with Rasters<a href="#challenge-work-with-rasters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="light-detection-and-ranging-lidar-data" class="section level2 hasAnchor" number="5.7">
<h2 class="hasAnchor"><span class="header-section-number">5.7</span> Light Detection And Ranging (LiDAR) Data<a href="#light-detection-and-ranging-lidar-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="calculating-forest-structural-diversity-metrics-from-neon-lidar-data" class="section level2 hasAnchor" number="5.8">
<h2 class="hasAnchor"><span class="header-section-number">5.8</span> Calculating Forest Structural Diversity Metrics from NEON LiDAR Data<a href="#calculating-forest-structural-diversity-metrics-from-neon-lidar-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="learning-objectives-4" class="section level3 hasAnchor" number="5.8.1">
<h3 class="hasAnchor"><span class="header-section-number">5.8.1</span> Learning Objectives<a href="#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="r-libraries-to-install-1" class="section level3 hasAnchor" number="5.8.2">
<h3 class="hasAnchor"><span class="header-section-number">5.8.2</span> R Libraries to Install:<a href="#r-libraries-to-install-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="data-to-download-1" class="section level3 hasAnchor" number="5.8.3">
<h3 class="hasAnchor"><span class="header-section-number">5.8.3</span> Data to Download<a href="#data-to-download-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="recommended-skills" class="section level3 hasAnchor" number="5.8.4">
<h3 class="hasAnchor"><span class="header-section-number">5.8.4</span> Recommended Skills<a href="#recommended-skills" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="additional-resources-2" class="section level3 hasAnchor" number="5.8.5">
<h3 class="hasAnchor"><span class="header-section-number">5.8.5</span> Additional Resources<a href="#additional-resources-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="introduction-to-structural-diversity-metrics" class="section level2 hasAnchor" number="5.9">
<h2 class="hasAnchor"><span class="header-section-number">5.9</span> Introduction to Structural Diversity Metrics<a href="#introduction-to-structural-diversity-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="neon-aop-discrete-return-lidar" class="section level2 hasAnchor" number="5.10">
<h2 class="hasAnchor"><span class="header-section-number">5.10</span> NEON AOP Discrete Return LIDAR<a href="#neon-aop-discrete-return-lidar" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="loading-the-lidar-products" class="section level3 hasAnchor" number="5.10.1">
<h3 class="hasAnchor"><span class="header-section-number">5.10.1</span> Loading the LIDAR Products<a href="#loading-the-lidar-products" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="normalizing-tree-height-to-ground" class="section level3 hasAnchor" number="5.10.2">
<h3 class="hasAnchor"><span class="header-section-number">5.10.2</span> Normalizing Tree Height to Ground<a href="#normalizing-tree-height-to-ground" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="calculating-structural-diversity-metrics" class="section level2 hasAnchor" number="5.11">
<h2 class="hasAnchor"><span class="header-section-number">5.11</span> Calculating Structural Diversity Metrics<a href="#calculating-structural-diversity-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="generate-canopy-height-model-chm" class="section level3 hasAnchor" number="5.11.1">
<h3 class="hasAnchor"><span class="header-section-number">5.11.1</span> GENERATE CANOPY HEIGHT MODEL (CHM)<a href="#generate-canopy-height-model-chm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="mean-outer-canopy-height-moch" class="section level4 hasAnchor" number="5.11.1.1">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.1</span> MEAN OUTER CANOPY HEIGHT (MOCH)<a href="#mean-outer-canopy-height-moch" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="max-canopy-height" class="section level4 hasAnchor" number="5.11.1.2">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.2</span> MAX CANOPY HEIGHT<a href="#max-canopy-height" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="rumple" class="section level4 hasAnchor" number="5.11.1.3">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.3</span> RUMPLE<a href="#rumple" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="top-rugosity" class="section level4 hasAnchor" number="5.11.1.4">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.4</span> TOP RUGOSITY<a href="#top-rugosity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="deep-gaps-deep-gap-fraction" class="section level4 hasAnchor" number="5.11.1.5">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.5</span> DEEP GAPS &amp; DEEP GAP FRACTION<a href="#deep-gaps-deep-gap-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="cover-fraction" class="section level4 hasAnchor" number="5.11.1.6">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.6</span> COVER FRACTION<a href="#cover-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="height-sd" class="section level4 hasAnchor" number="5.11.1.7">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.7</span> HEIGHT SD<a href="#height-sd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="entropy" class="section level4 hasAnchor" number="5.11.1.8">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.8</span> ENTROPY<a href="#entropy" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="gap-fraction-profile" class="section level4 hasAnchor" number="5.11.1.9">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.9</span> GAP FRACTION PROFILE<a href="#gap-fraction-profile" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="vai" class="section level4 hasAnchor" number="5.11.1.10">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.10</span> VAI<a href="#vai" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="vci" class="section level4 hasAnchor" number="5.11.1.11">
<h4 class="hasAnchor"><span class="header-section-number">5.11.1.11</span> VCI<a href="#vci" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="combining-everything-into-one-function" class="section level3 hasAnchor" number="5.11.2">
<h3 class="hasAnchor"><span class="header-section-number">5.11.2</span> Combining Everything Into One Function<a href="#combining-everything-into-one-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="comparing-metrics-between-forests" class="section level3 hasAnchor" number="5.11.3">
<h3 class="hasAnchor"><span class="header-section-number">5.11.3</span> Comparing Metrics Between Forests<a href="#comparing-metrics-between-forests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="matching-gedi-waveforms-with-neon-aop-lidar-pointclouds" class="section level2 hasAnchor" number="5.12">
<h2 class="hasAnchor"><span class="header-section-number">5.12</span> Matching GEDI waveforms with NEON AOP LiDAR pointclouds<a href="#matching-gedi-waveforms-with-neon-aop-lidar-pointclouds" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="learning-objectives-5" class="section level3 hasAnchor" number="5.12.1">
<h3 class="hasAnchor"><span class="header-section-number">5.12.1</span> Learning Objectives<a href="#learning-objectives-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="things-youll-need-to-complete-this-gedi-section" class="section level3 hasAnchor" number="5.12.2">
<h3 class="hasAnchor"><span class="header-section-number">5.12.2</span> Things You’ll Need To Complete This GEDI Section<a href="#things-youll-need-to-complete-this-gedi-section" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="r-packages-to-install" class="section level3 hasAnchor" number="5.12.3">
<h3 class="hasAnchor"><span class="header-section-number">5.12.3</span> R Packages to Install<a href="#r-packages-to-install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="example-data-set" class="section level3 hasAnchor" number="5.12.4">
<h3 class="hasAnchor"><span class="header-section-number">5.12.4</span> Example Data Set<a href="#example-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="gedi-example-data-subset" class="section level4 hasAnchor" number="5.12.4.1">
<h4 class="hasAnchor"><span class="header-section-number">5.12.4.1</span> GEDI Example Data Subset<a href="#gedi-example-data-subset" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="datum-difference-between-wgs84-and-nad83" class="section level4 hasAnchor" number="5.12.4.2">
<h4 class="hasAnchor"><span class="header-section-number">5.12.4.2</span> Datum difference between WGS84 and NAD83<a href="#datum-difference-between-wgs84-and-nad83" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="datum-difference-between-geoid12a-and-nad83" class="section level4 hasAnchor" number="5.12.4.3">
<h4 class="hasAnchor"><span class="header-section-number">5.12.4.3</span> Datum difference between GEOID12A and NAD83<a href="#datum-difference-between-geoid12a-and-nad83" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="getting-started" class="section level3 hasAnchor" number="5.12.5">
<h3 class="hasAnchor"><span class="header-section-number">5.12.5</span> Getting Started<a href="#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="downloading-gedi-data" class="section level3 hasAnchor" number="5.12.6">
<h3 class="hasAnchor"><span class="header-section-number">5.12.6</span> Downloading GEDI data<a href="#downloading-gedi-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="plot-gedi-footprints-on-chm" class="section level3 hasAnchor" number="5.12.7">
<h3 class="hasAnchor"><span class="header-section-number">5.12.7</span> Plot GEDI footprints on CHM<a href="#plot-gedi-footprints-on-chm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="extract-waveform-for-a-single-shot" class="section level3 hasAnchor" number="5.12.8">
<h3 class="hasAnchor"><span class="header-section-number">5.12.8</span> Extract Waveform for a single Shot<a href="#extract-waveform-for-a-single-shot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="download-and-plot-neon-aop-lidar-pointcloud-data" class="section level3 hasAnchor" number="5.12.9">
<h3 class="hasAnchor"><span class="header-section-number">5.12.9</span> Download and Plot NEON AOP LiDAR pointcloud data<a href="#download-and-plot-neon-aop-lidar-pointcloud-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="clip-aop-lidar-pointcloud-to-gedi-footprints" class="section level3 hasAnchor" number="5.12.10">
<h3 class="hasAnchor"><span class="header-section-number">5.12.10</span> Clip AOP LiDAR Pointcloud to GEDI footprints<a href="#clip-aop-lidar-pointcloud-to-gedi-footprints" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="plot-gedi-waveform-with-aop-pointcloud-in-3d-space" class="section level3 hasAnchor" number="5.12.11">
<h3 class="hasAnchor"><span class="header-section-number">5.12.11</span> Plot GEDI Waveform with AOP Pointcloud in 3D space<a href="#plot-gedi-waveform-with-aop-pointcloud-in-3d-space" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="datum-geoid-and-how-to-best-measure-the-earth" class="section level3 hasAnchor" number="5.12.12">
<h3 class="hasAnchor"><span class="header-section-number">5.12.12</span> Datum, Geoid, and how to best measure the Earth<a href="#datum-geoid-and-how-to-best-measure-the-earth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="wgs84" class="section level4 hasAnchor" number="5.12.12.1">
<h4 class="hasAnchor"><span class="header-section-number">5.12.12.1</span> WGS84<a href="#wgs84" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="geoid12a" class="section level4 hasAnchor" number="5.12.12.2">
<h4 class="hasAnchor"><span class="header-section-number">5.12.12.2</span> GEOID12A<a href="#geoid12a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="aligning-the-vertical-datum" class="section level3 hasAnchor" number="5.12.13">
<h3 class="hasAnchor"><span class="header-section-number">5.12.13</span> Aligning the Vertical Datum<a href="#aligning-the-vertical-datum" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="geoid12a-height-model" class="section level3 hasAnchor" number="5.12.14">
<h3 class="hasAnchor"><span class="header-section-number">5.12.14</span> GEOID12A Height Model<a href="#geoid12a-height-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="extract-vertical-offset-for-gedi-shots" class="section level3 hasAnchor" number="5.12.15">
<h3 class="hasAnchor"><span class="header-section-number">5.12.15</span> Extract vertical offset for GEDI shots<a href="#extract-vertical-offset-for-gedi-shots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="plot-vertically-corrected-gedi-waveform-in-3d" class="section level3 hasAnchor" number="5.12.16">
<h3 class="hasAnchor"><span class="header-section-number">5.12.16</span> Plot vertically corrected GEDI waveform in 3D<a href="#plot-vertically-corrected-gedi-waveform-in-3d" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="optional---neon-base-plots" class="section level3 hasAnchor" number="5.12.17">
<h3 class="hasAnchor"><span class="header-section-number">5.12.17</span> Optional - NEON base plots<a href="#optional---neon-base-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="neon-aop-written-questions" class="section level2 hasAnchor" number="5.13">
<h2 class="hasAnchor"><span class="header-section-number">5.13</span> NEON AOP Written Questions:<a href="#neon-aop-written-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="neon-aop-coding-lab" class="section level2 hasAnchor" number="5.14">
<h2 class="hasAnchor"><span class="header-section-number">5.14</span> NEON AOP Coding Lab<a href="#neon-aop-coding-lab" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="neon-aop-culmination-write-up" class="section level2 hasAnchor" number="5.15">
<h2 class="hasAnchor"><span class="header-section-number">5.15</span> NEON AOP Culmination Write Up<a href="#neon-aop-culmination-write-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:07-NEON_AOP.Rmd-->
</div>
</div>
<div id="nasas-earth-observing-system-eos" class="section level1 hasAnchor" number="6">
<h1 class="hasAnchor"><span class="header-section-number">6</span> NASA’s Earth Observing System (EOS)<a href="#nasas-earth-observing-system-eos" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="learning-objectives-6" class="section level2 hasAnchor" number="6.1">
<h2 class="hasAnchor"><span class="header-section-number">6.1</span> Learning Objectives<a href="#learning-objectives-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="nasa-eos-project-mission-design" class="section level2 hasAnchor" number="6.2">
<h2 class="hasAnchor"><span class="header-section-number">6.2</span> NASA EOS Project Mission &amp; Design<a href="#nasa-eos-project-mission-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="nasa-eos-earth-data-account" class="section level2 hasAnchor" number="6.3">
<h2 class="hasAnchor"><span class="header-section-number">6.3</span> NASA EOS Earth Data Account:<a href="#nasa-eos-earth-data-account" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="nasa-eos-coding-assignment-1" class="section level2 hasAnchor" number="6.4">
<h2 class="hasAnchor"><span class="header-section-number">6.4</span> <strong>NASA EOS Coding Assignment 1</strong><a href="#nasa-eos-coding-assignment-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="distributed-active-archive-centers" class="section level2 hasAnchor" number="6.5">
<h2 class="hasAnchor"><span class="header-section-number">6.5</span> Distributed Active Archive Centers<a href="#distributed-active-archive-centers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lp-daac" class="section level3 hasAnchor" number="6.5.1">
<h3 class="hasAnchor"><span class="header-section-number">6.5.1</span> LP DAAC<a href="#lp-daac" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="the-lpdaac-mission-process-archive-distribute-apply" class="section level2 hasAnchor" number="6.6">
<h2 class="hasAnchor"><span class="header-section-number">6.6</span> The LPDAAC Mission: Process, Archive, Distribute, Apply<a href="#the-lpdaac-mission-process-archive-distribute-apply" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="how-you-can-use-lp-daacs-data" class="section level3 hasAnchor" number="6.6.1">
<h3 class="hasAnchor"><span class="header-section-number">6.6.1</span> How you can use LP DAAC’s data<a href="#how-you-can-use-lp-daacs-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="appeears" class="section level2 hasAnchor" number="6.7">
<h2 class="hasAnchor"><span class="header-section-number">6.7</span> AppEEARS<a href="#appeears" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="hands-on-pulling-appeears-data-via-the-api" class="section level2 hasAnchor" number="6.8">
<h2 class="hasAnchor"><span class="header-section-number">6.8</span> Hands on: Pulling AppEEARS Data via the API<a href="#hands-on-pulling-appeears-data-via-the-api" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="getting-started-with-the-appeears-api-point-request" class="section level2 hasAnchor" number="6.9">
<h2 class="hasAnchor"><span class="header-section-number">6.9</span> Getting Started with the AppEEARS API (Point Request)<a href="#getting-started-with-the-appeears-api-point-request" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-submit-a-point-request-for-multiple-neon-sites-to-extract-vegetation-and-land-surface-temperature-data" class="section level3 hasAnchor" number="6.9.1">
<h3 class="hasAnchor"><span class="header-section-number">6.9.1</span> Example: Submit a point request for multiple NEON sites to extract vegetation and land surface temperature data<a href="#example-submit-a-point-request-for-multiple-neon-sites-to-extract-vegetation-and-land-surface-temperature-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="data-used-in-the-example" class="section level4 hasAnchor" number="6.9.1.1">
<h4 class="hasAnchor"><span class="header-section-number">6.9.1.1</span> Data Used in the Example:<a href="#data-used-in-the-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="topics-covered-in-this-section" class="section level2 hasAnchor" number="6.10">
<h2 class="hasAnchor"><span class="header-section-number">6.10</span> Topics Covered in this section:<a href="#topics-covered-in-this-section" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="prerequisites" class="section level3 hasAnchor" number="6.10.1">
<h3 class="hasAnchor"><span class="header-section-number">6.10.1</span> Prerequisites:<a href="#prerequisites" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="getting-started-1" class="section level4 hasAnchor" number="6.10.1.1">
<h4 class="hasAnchor"><span class="header-section-number">6.10.1.1</span> Getting Started:<a href="#getting-started-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="appeears-information" class="section level3 hasAnchor" number="6.10.2">
<h3 class="hasAnchor"><span class="header-section-number">6.10.2</span> AppEEARS Information:<a href="#appeears-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="getting-started-with-the-appeears-api" class="section level2 hasAnchor" number="6.11">
<h2 class="hasAnchor"><span class="header-section-number">6.11</span> Getting Started with the AppEEARS API<a href="#getting-started-with-the-appeears-api" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-packages" class="section level3 hasAnchor" number="6.11.1">
<h3 class="hasAnchor"><span class="header-section-number">6.11.1</span> Load Packages<a href="#load-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="set-up-the-output-directory" class="section level3 hasAnchor" number="6.11.2">
<h3 class="hasAnchor"><span class="header-section-number">6.11.2</span> Set Up the Output Directory<a href="#set-up-the-output-directory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="login-to-earth-data" class="section level3 hasAnchor" number="6.11.3">
<h3 class="hasAnchor"><span class="header-section-number">6.11.3</span> Login to Earth Data<a href="#login-to-earth-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="query-available-products" class="section level2 hasAnchor" number="6.12">
<h2 class="hasAnchor"><span class="header-section-number">6.12</span> Query Available Products<a href="#query-available-products" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="search-and-explore-available-products" class="section level2 hasAnchor" number="6.13">
<h2 class="hasAnchor"><span class="header-section-number">6.13</span> Search and Explore Available Products<a href="#search-and-explore-available-products" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="search-and-explore-available-layers" class="section level2 hasAnchor" number="6.14">
<h2 class="hasAnchor"><span class="header-section-number">6.14</span> Search and Explore Available Layers<a href="#search-and-explore-available-layers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="submit-a-point-request" class="section level2 hasAnchor" number="6.15">
<h2 class="hasAnchor"><span class="header-section-number">6.15</span> Submit a Point Request<a href="#submit-a-point-request" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="compile-a-json-object" class="section level3 hasAnchor" number="6.15.1">
<h3 class="hasAnchor"><span class="header-section-number">6.15.1</span> Compile a JSON Object<a href="#compile-a-json-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="submit-a-task-request" class="section level3 hasAnchor" number="6.15.2">
<h3 class="hasAnchor"><span class="header-section-number">6.15.2</span> Submit a Task Request<a href="#submit-a-task-request" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="retrieve-task-status" class="section level3 hasAnchor" number="6.15.3">
<h3 class="hasAnchor"><span class="header-section-number">6.15.3</span> Retrieve Task Status<a href="#retrieve-task-status" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="download-a-request" class="section level2 hasAnchor" number="6.16">
<h2 class="hasAnchor"><span class="header-section-number">6.16</span> Download a Request<a href="#download-a-request" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="explore-files-in-request-output" class="section level3 hasAnchor" number="6.16.1">
<h3 class="hasAnchor"><span class="header-section-number">6.16.1</span> Explore Files in Request Output<a href="#explore-files-in-request-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="download-files-in-a-request-automation" class="section level2 hasAnchor" number="6.17">
<h2 class="hasAnchor"><span class="header-section-number">6.17</span> Download Files in a Request (Automation)<a href="#download-files-in-a-request-automation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="explore-appeears-quality-service" class="section level2 hasAnchor" number="6.18">
<h2 class="hasAnchor"><span class="header-section-number">6.18</span> Explore AppEEARS Quality Service<a href="#explore-appeears-quality-service" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="list-quality-layers" class="section level3 hasAnchor" number="6.18.1">
<h3 class="hasAnchor"><span class="header-section-number">6.18.1</span> List Quality Layers<a href="#list-quality-layers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="inspect-quality-values" class="section level3 hasAnchor" number="6.18.2">
<h3 class="hasAnchor"><span class="header-section-number">6.18.2</span> Inspect Quality Values<a href="#inspect-quality-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="decode-quality-values" class="section level2 hasAnchor" number="6.19">
<h2 class="hasAnchor"><span class="header-section-number">6.19</span> Decode Quality Values<a href="#decode-quality-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="load-request-output-and-visualize" class="section level2 hasAnchor" number="6.20">
<h2 class="hasAnchor"><span class="header-section-number">6.20</span> Load Request Output and Visualize<a href="#load-request-output-and-visualize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="load-a-csv" class="section level2 hasAnchor" number="6.21">
<h2 class="hasAnchor"><span class="header-section-number">6.21</span> Load a CSV<a href="#load-a-csv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="plot-results-linescatter-plots" class="section level2 hasAnchor" number="6.22">
<h2 class="hasAnchor"><span class="header-section-number">6.22</span> Plot Results (Line/Scatter Plots)<a href="#plot-results-linescatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="submit-an-area-request" class="section level2 hasAnchor" number="6.23">
<h2 class="hasAnchor"><span class="header-section-number">6.23</span> Submit an Area Request<a href="#submit-an-area-request" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="submit-an-area-request-using-a-neon-site-boundary-as-the-region-of-interest-for-extracting-elevation-vegetation-and-land-surface-temperature-data" class="section level2 hasAnchor" number="6.24">
<h2 class="hasAnchor"><span class="header-section-number">6.24</span> Submit an area request using a NEON site boundary as the region of interest for extracting elevation, vegetation and land surface temperature data<a href="#submit-an-area-request-using-a-neon-site-boundary-as-the-region-of-interest-for-extracting-elevation-vegetation-and-land-surface-temperature-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-used-in-this-example" class="section level4 hasAnchor" number="6.24.0.1">
<h4 class="hasAnchor"><span class="header-section-number">6.24.0.1</span> Data Used in this Example:<a href="#data-used-in-this-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="topics-covered-in-this-tutorial" class="section level3 hasAnchor" number="6.24.1">
<h3 class="hasAnchor"><span class="header-section-number">6.24.1</span> Topics Covered in this Tutorial<a href="#topics-covered-in-this-tutorial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="prerequisites-1" class="section level3 hasAnchor" number="6.24.2">
<h3 class="hasAnchor"><span class="header-section-number">6.24.2</span> Prerequisites:<a href="#prerequisites-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="procedures" class="section level3 hasAnchor" number="6.24.3">
<h3 class="hasAnchor"><span class="header-section-number">6.24.3</span> Procedures:<a href="#procedures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="getting-started-2" class="section level4 hasAnchor" number="6.24.3.1">
<h4 class="hasAnchor"><span class="header-section-number">6.24.3.1</span> Getting Started:<a href="#getting-started-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="appeears-information-1" class="section level3 hasAnchor" number="6.24.4">
<h3 class="hasAnchor"><span class="header-section-number">6.24.4</span> AppEEARS Information:<a href="#appeears-information-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="getting-started-with-an-area-request" class="section level2 hasAnchor" number="6.25">
<h2 class="hasAnchor"><span class="header-section-number">6.25</span> Getting Started with an Area Request<a href="#getting-started-with-an-area-request" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-packages-for-an-area-request" class="section level3 hasAnchor" number="6.25.1">
<h3 class="hasAnchor"><span class="header-section-number">6.25.1</span> Load Packages for an Area Request<a href="#load-packages-for-an-area-request" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="set-up-the-output-directory-1" class="section level2 hasAnchor" number="6.26">
<h2 class="hasAnchor"><span class="header-section-number">6.26</span> Set Up the Output Directory<a href="#set-up-the-output-directory-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="load-your-earth-data-token" class="section level2 hasAnchor" number="6.27">
<h2 class="hasAnchor"><span class="header-section-number">6.27</span> Load your Earth Data Token<a href="#load-your-earth-data-token" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="query-available-products-1" class="section level2 hasAnchor" number="6.28">
<h2 class="hasAnchor"><span class="header-section-number">6.28</span> Query Available Products<a href="#query-available-products-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="search-and-explore-available-products-1" class="section level2 hasAnchor" number="6.29">
<h2 class="hasAnchor"><span class="header-section-number">6.29</span> Search and Explore Available Products<a href="#search-and-explore-available-products-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="search-and-explore-available-layers-1" class="section level2 hasAnchor" number="6.30">
<h2 class="hasAnchor"><span class="header-section-number">6.30</span> Search and Explore Available Layers<a href="#search-and-explore-available-layers-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="submit-an-area-request-1" class="section level2 hasAnchor" number="6.31">
<h2 class="hasAnchor"><span class="header-section-number">6.31</span> Submit an Area Request<a href="#submit-an-area-request-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-a-shapefile" class="section level3 hasAnchor" number="6.31.1">
<h3 class="hasAnchor"><span class="header-section-number">6.31.1</span> Load a Shapefile<a href="#load-a-shapefile" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="search-and-explore-available-projections" class="section level2 hasAnchor" number="6.32">
<h2 class="hasAnchor"><span class="header-section-number">6.32</span> Search and Explore Available Projections<a href="#search-and-explore-available-projections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="compile-a-json-object-1" class="section level2 hasAnchor" number="6.33">
<h2 class="hasAnchor"><span class="header-section-number">6.33</span> Compile a JSON Object<a href="#compile-a-json-object-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="submit-a-task-request-1" class="section level2 hasAnchor" number="6.34">
<h2 class="hasAnchor"><span class="header-section-number">6.34</span> Submit a Task Request<a href="#submit-a-task-request-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="retrieve-task-status-1" class="section level2 hasAnchor" number="6.35">
<h2 class="hasAnchor"><span class="header-section-number">6.35</span> Retrieve Task Status<a href="#retrieve-task-status-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="download-a-request-1" class="section level2 hasAnchor" number="6.36">
<h2 class="hasAnchor"><span class="header-section-number">6.36</span> Download a Request<a href="#download-a-request-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="explore-files-in-request-output-1" class="section level3 hasAnchor" number="6.36.1">
<h3 class="hasAnchor"><span class="header-section-number">6.36.1</span> Explore Files in Request Output<a href="#explore-files-in-request-output-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="download-files-in-a-request-automation-1" class="section level2 hasAnchor" number="6.37">
<h2 class="hasAnchor"><span class="header-section-number">6.37</span> Download Files in a Request (Automation)<a href="#download-files-in-a-request-automation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="explore-appeears-quality-service-1" class="section level2 hasAnchor" number="6.38">
<h2 class="hasAnchor"><span class="header-section-number">6.38</span> Explore AppEEARS Quality Service<a href="#explore-appeears-quality-service-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="list-quality-layers-1" class="section level2 hasAnchor" number="6.39">
<h2 class="hasAnchor"><span class="header-section-number">6.39</span> List Quality Layers<a href="#list-quality-layers-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="show-quality-values" class="section level2 hasAnchor" number="6.40">
<h2 class="hasAnchor"><span class="header-section-number">6.40</span> Show Quality Values<a href="#show-quality-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="decode-quality-values-1" class="section level2 hasAnchor" number="6.41">
<h2 class="hasAnchor"><span class="header-section-number">6.41</span> Decode Quality Values<a href="#decode-quality-values-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="bonus-load-request-output-and-visualize" class="section level2 hasAnchor" number="6.42">
<h2 class="hasAnchor"><span class="header-section-number">6.42</span> BONUS: Load Request Output and Visualize<a href="#bonus-load-request-output-and-visualize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="load-a-geotiff" class="section level2 hasAnchor" number="6.43">
<h2 class="hasAnchor"><span class="header-section-number">6.43</span> Load a GeoTIFF<a href="#load-a-geotiff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="plot-a-geotiff" class="section level2 hasAnchor" number="6.44">
<h2 class="hasAnchor"><span class="header-section-number">6.44</span> Plot a GeoTIFF<a href="#plot-a-geotiff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="nasa-eos-coding-lab-2" class="section level2 hasAnchor" number="6.45">
<h2 class="hasAnchor"><span class="header-section-number">6.45</span> NASA EOS Coding Lab #2<a href="#nasa-eos-coding-lab-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="nasa-eos-written-questions" class="section level2 hasAnchor" number="6.46">
<h2 class="hasAnchor"><span class="header-section-number">6.46</span> NASA EOS Written Questions<a href="#nasa-eos-written-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="nasa-eos-culmination-write-up" class="section level2 hasAnchor" number="6.47">
<h2 class="hasAnchor"><span class="header-section-number">6.47</span> NASA EOS Culmination Write Up<a href="#nasa-eos-culmination-write-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:08-NASA_EOS.Rmd-->
</div>
</div>
<div id="usgs-national-water-information-system-nwis" class="section level1 hasAnchor" number="7">
<h1 class="hasAnchor"><span class="header-section-number">7</span> USGS National Water Information System (NWIS)<a href="#usgs-national-water-information-system-nwis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="usgs-mission" class="section level2 hasAnchor" number="7.1">
<h2 class="hasAnchor"><span class="header-section-number">7.1</span> USGS Mission:<a href="#usgs-mission" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="usgs-water-resources-mission" class="section level2 hasAnchor" number="7.2">
<h2 class="hasAnchor"><span class="header-section-number">7.2</span> USGS Water Resources Mission:<a href="#usgs-water-resources-mission" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="types-of-usgs-nwis-data" class="section level2 hasAnchor" number="7.3">
<h2 class="hasAnchor"><span class="header-section-number">7.3</span> Types of USGS NWIS Data<a href="#types-of-usgs-nwis-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="usgs-r-packages-collaborative-and-reproducible-data-analysis-using-r" class="section level2 hasAnchor" number="7.4">
<h2 class="hasAnchor"><span class="header-section-number">7.4</span> USGS R Packages: Collaborative and reproducible data analysis using R<a href="#usgs-r-packages-collaborative-and-reproducible-data-analysis-using-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="suggested-prerequisite-knowledge" class="section level3 hasAnchor" number="7.4.1">
<h3 class="hasAnchor"><span class="header-section-number">7.4.1</span> Suggested prerequisite knowledge<a href="#suggested-prerequisite-knowledge" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="course-outline" class="section level3 hasAnchor" number="7.4.2">
<h3 class="hasAnchor"><span class="header-section-number">7.4.2</span> Course outline<a href="#course-outline" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="software-requirements" class="section level3 hasAnchor" number="7.4.3">
<h3 class="hasAnchor"><span class="header-section-number">7.4.3</span> Software requirements<a href="#software-requirements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="lesson-summary" class="section level3 hasAnchor" number="7.4.4">
<h3 class="hasAnchor"><span class="header-section-number">7.4.4</span> Lesson Summary<a href="#lesson-summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="lesson-objectives" class="section level3 hasAnchor" number="7.4.5">
<h3 class="hasAnchor"><span class="header-section-number">7.4.5</span> Lesson Objectives<a href="#lesson-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="lesson-resources" class="section level3 hasAnchor" number="7.4.6">
<h3 class="hasAnchor"><span class="header-section-number">7.4.6</span> Lesson Resources<a href="#lesson-resources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="lesson-slide-deck" class="section level3 hasAnchor" number="7.4.7">
<h3 class="hasAnchor"><span class="header-section-number">7.4.7</span> Lesson Slide Deck<a href="#lesson-slide-deck" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="introduction-to-usgs-r-packages" class="section level2 hasAnchor" number="7.5">
<h2 class="hasAnchor"><span class="header-section-number">7.5</span> Introduction to USGS R Packages<a href="#introduction-to-usgs-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="data-available" class="section level2 hasAnchor" number="7.6">
<h2 class="hasAnchor"><span class="header-section-number">7.6</span> Data available<a href="#data-available" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="common-nwis-function-arguments" class="section level2 hasAnchor" number="7.7">
<h2 class="hasAnchor"><span class="header-section-number">7.7</span> Common NWIS function arguments<a href="#common-nwis-function-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="discovering-nwis-data" class="section level2 hasAnchor" number="7.8">
<h2 class="hasAnchor"><span class="header-section-number">7.8</span> Discovering NWIS data<a href="#discovering-nwis-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="whatnwisdata" class="section level3 hasAnchor" number="7.8.1">
<h3 class="hasAnchor"><span class="header-section-number">7.8.1</span> whatNWISdata<a href="#whatnwisdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="common-wqp-function-arguments" class="section level2 hasAnchor" number="7.9">
<h2 class="hasAnchor"><span class="header-section-number">7.9</span> Common WQP function arguments<a href="#common-wqp-function-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="discovering-wqp-data" class="section level2 hasAnchor" number="7.10">
<h2 class="hasAnchor"><span class="header-section-number">7.10</span> Discovering WQP data<a href="#discovering-wqp-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="readwqpdata-querysummary" class="section level3 hasAnchor" number="7.10.1">
<h3 class="hasAnchor"><span class="header-section-number">7.10.1</span> readWQPdata + querySummary<a href="#readwqpdata-querysummary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="whatwqpsites" class="section level3 hasAnchor" number="7.10.2">
<h3 class="hasAnchor"><span class="header-section-number">7.10.2</span> whatWQPsites<a href="#whatwqpsites" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="readnwis-functions" class="section level2 hasAnchor" number="7.11">
<h2 class="hasAnchor"><span class="header-section-number">7.11</span> readNWIS functions<a href="#readnwis-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="readnwisdata" class="section level3 hasAnchor" number="7.11.1">
<h3 class="hasAnchor"><span class="header-section-number">7.11.1</span> readNWISdata<a href="#readnwisdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwisdv" class="section level3 hasAnchor" number="7.11.2">
<h3 class="hasAnchor"><span class="header-section-number">7.11.2</span> readNWISdv<a href="#readnwisdv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwisgwl" class="section level3 hasAnchor" number="7.11.3">
<h3 class="hasAnchor"><span class="header-section-number">7.11.3</span> readNWISgwl<a href="#readnwisgwl" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwismeas" class="section level3 hasAnchor" number="7.11.4">
<h3 class="hasAnchor"><span class="header-section-number">7.11.4</span> readNWISmeas<a href="#readnwismeas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwispcode" class="section level3 hasAnchor" number="7.11.5">
<h3 class="hasAnchor"><span class="header-section-number">7.11.5</span> readNWISpCode<a href="#readnwispcode" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwispeak" class="section level3 hasAnchor" number="7.11.6">
<h3 class="hasAnchor"><span class="header-section-number">7.11.6</span> readNWISpeak<a href="#readnwispeak" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwisqw" class="section level3 hasAnchor" number="7.11.7">
<h3 class="hasAnchor"><span class="header-section-number">7.11.7</span> readNWISqw<a href="#readnwisqw" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwisrating" class="section level3 hasAnchor" number="7.11.8">
<h3 class="hasAnchor"><span class="header-section-number">7.11.8</span> readNWISrating<a href="#readnwisrating" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwissite" class="section level3 hasAnchor" number="7.11.9">
<h3 class="hasAnchor"><span class="header-section-number">7.11.9</span> readNWISsite<a href="#readnwissite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwisstat" class="section level3 hasAnchor" number="7.11.10">
<h3 class="hasAnchor"><span class="header-section-number">7.11.10</span> readNWISstat<a href="#readnwisstat" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwisuse" class="section level3 hasAnchor" number="7.11.11">
<h3 class="hasAnchor"><span class="header-section-number">7.11.11</span> readNWISuse<a href="#readnwisuse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readnwisuv" class="section level3 hasAnchor" number="7.11.12">
<h3 class="hasAnchor"><span class="header-section-number">7.11.12</span> readNWISuv<a href="#readnwisuv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="additional-features" class="section level2 hasAnchor" number="7.12">
<h2 class="hasAnchor"><span class="header-section-number">7.12</span> Additional Features<a href="#additional-features" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="accessing-attributes" class="section level3 hasAnchor" number="7.12.1">
<h3 class="hasAnchor"><span class="header-section-number">7.12.1</span> Accessing attributes<a href="#accessing-attributes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="using-lists-as-input" class="section level3 hasAnchor" number="7.12.2">
<h3 class="hasAnchor"><span class="header-section-number">7.12.2</span> Using lists as input<a href="#using-lists-as-input" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="helper-functions" class="section level3 hasAnchor" number="7.12.3">
<h3 class="hasAnchor"><span class="header-section-number">7.12.3</span> Helper functions<a href="#helper-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="readwqp-functions" class="section level2 hasAnchor" number="7.13">
<h2 class="hasAnchor"><span class="header-section-number">7.13</span> readWQP functions<a href="#readwqp-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="readwqpdata" class="section level3 hasAnchor" number="7.13.1">
<h3 class="hasAnchor"><span class="header-section-number">7.13.1</span> readWQPdata<a href="#readwqpdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="readwqpqw" class="section level3 hasAnchor" number="7.13.2">
<h3 class="hasAnchor"><span class="header-section-number">7.13.2</span> readWQPqw<a href="#readwqpqw" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="attributes-and-metadata" class="section level2 hasAnchor" number="7.14">
<h2 class="hasAnchor"><span class="header-section-number">7.14</span> Attributes and metadata<a href="#attributes-and-metadata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="usgs-coding-lab-exercises" class="section level2 hasAnchor" number="7.15">
<h2 class="hasAnchor"><span class="header-section-number">7.15</span> USGS Coding Lab Exercises<a href="#usgs-coding-lab-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="just-how-dry-was-the-2020-monsoon" class="section level3 hasAnchor" number="7.15.1">
<h3 class="hasAnchor"><span class="header-section-number">7.15.1</span> Just how dry was the 2020 monsoon?<a href="#just-how-dry-was-the-2020-monsoon" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="geoknife---introduction" class="section level2 hasAnchor" number="7.16">
<h2 class="hasAnchor"><span class="header-section-number">7.16</span> geoKnife - Introduction<a href="#geoknife---introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="lesson-summary-1" class="section level2 hasAnchor" number="7.17">
<h2 class="hasAnchor"><span class="header-section-number">7.17</span> Lesson Summary<a href="#lesson-summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="lesson-objectives-1" class="section level2 hasAnchor" number="7.18">
<h2 class="hasAnchor"><span class="header-section-number">7.18</span> Lesson Objectives<a href="#lesson-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="lesson-resources-1" class="section level2 hasAnchor" number="7.19">
<h2 class="hasAnchor"><span class="header-section-number">7.19</span> Lesson Resources<a href="#lesson-resources-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="remote-processing" class="section level2 hasAnchor" number="7.20">
<h2 class="hasAnchor"><span class="header-section-number">7.20</span> Remote processing<a href="#remote-processing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="geoknife-components-fabric-stencil-knife" class="section level2 hasAnchor" number="7.21">
<h2 class="hasAnchor"><span class="header-section-number">7.21</span> geoknife components: fabric, stencil, knife<a href="#geoknife-components-fabric-stencil-knife" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="available-webdata" class="section level2 hasAnchor" number="7.22">
<h2 class="hasAnchor"><span class="header-section-number">7.22</span> Available webdata<a href="#available-webdata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="gdp-datasets" class="section level3 hasAnchor" number="7.22.1">
<h3 class="hasAnchor"><span class="header-section-number">7.22.1</span> GDP datasets<a href="#gdp-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="datasets-not-in-gdp" class="section level3 hasAnchor" number="7.22.2">
<h3 class="hasAnchor"><span class="header-section-number">7.22.2</span> Datasets not in GDP<a href="#datasets-not-in-gdp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="available-webgeoms" class="section level2 hasAnchor" number="7.23">
<h2 class="hasAnchor"><span class="header-section-number">7.23</span> Available webgeoms<a href="#available-webgeoms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="available-webprocesses" class="section level2 hasAnchor" number="7.24">
<h2 class="hasAnchor"><span class="header-section-number">7.24</span> Available webprocesses<a href="#available-webprocesses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="setting-up-a-geojob" class="section level2 hasAnchor" number="7.25">
<h2 class="hasAnchor"><span class="header-section-number">7.25</span> Setting up a geojob<a href="#setting-up-a-geojob" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="checking-the-geojob-status" class="section level2 hasAnchor" number="7.26">
<h2 class="hasAnchor"><span class="header-section-number">7.26</span> Checking the geojob status<a href="#checking-the-geojob-status" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="getting-geojob-data" class="section level2 hasAnchor" number="7.27">
<h2 class="hasAnchor"><span class="header-section-number">7.27</span> Getting geojob data<a href="#getting-geojob-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="wait-and-email" class="section level2 hasAnchor" number="7.28">
<h2 class="hasAnchor"><span class="header-section-number">7.28</span> <code>wait</code> and <code>email</code><a href="#wait-and-email" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="putting-it-all-together-mapping-precipitation-from-tropical-storm-colin" class="section level2 hasAnchor" number="7.29">
<h2 class="hasAnchor"><span class="header-section-number">7.29</span> Putting it all together, mapping precipitation from Tropical Storm Colin<a href="#putting-it-all-together-mapping-precipitation-from-tropical-storm-colin" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="usgs-nwis-culmination-write-up" class="section level2 hasAnchor" number="7.30">
<h2 class="hasAnchor"><span class="header-section-number">7.30</span> USGS NWIS Culmination Write Up<a href="#usgs-nwis-culmination-write-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:08-USGS.Rmd-->
</div>
</div>
<div id="frequently-asked-questions" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Frequently Asked Questions:<a href="#frequently-asked-questions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Placeholder</p>
<div id="where-can-i-find-due-dates-for-assignments" class="section level2 hasAnchor" number="7.31">
<h2 class="hasAnchor"><span class="header-section-number">7.31</span> Where can I find due dates for assignments?<a href="#where-can-i-find-due-dates-for-assignments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="how-do-i-submit-assignments" class="section level2 hasAnchor" number="7.32">
<h2 class="hasAnchor"><span class="header-section-number">7.32</span> How do I submit assignments?<a href="#how-do-i-submit-assignments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="do-i-still-have-to-submit-written-exercises-as-.rmd-and-.pdf" class="section level2 hasAnchor" number="7.33">
<h2 class="hasAnchor"><span class="header-section-number">7.33</span> Do I still have to submit written exercises as .Rmd and .pdf?<a href="#do-i-still-have-to-submit-written-exercises-as-.rmd-and-.pdf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="whats-better-for-code-conciseness-or-readability" class="section level2 hasAnchor" number="7.34">
<h2 class="hasAnchor"><span class="header-section-number">7.34</span> What’s better for code, conciseness or readability?<a href="#whats-better-for-code-conciseness-or-readability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="how-find-i-find-resources-to-navigate-the-neon-data-portal" class="section level2 hasAnchor" number="7.35">
<h2 class="hasAnchor"><span class="header-section-number">7.35</span> How find I find resources to navigate the NEON Data Portal?<a href="#how-find-i-find-resources-to-navigate-the-neon-data-portal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="how-can-i-best-prepare-for-class-and-succeed" class="section level2 hasAnchor" number="7.36">
<h2 class="hasAnchor"><span class="header-section-number">7.36</span> How can I best prepare for class and succeed?<a href="#how-can-i-best-prepare-for-class-and-succeed" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:15_FAQ.Rmd-->
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
